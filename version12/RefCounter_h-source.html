<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>/magnus/back_end/global/RefCounter.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.6 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>/magnus/back_end/global/RefCounter.h</h1><a href="RefCounter_h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="comment">/*</font>
00002 <font class="comment"> *   $Id: RefCounter.h,v 1.1.1.1 1995/11/20 17:54:39 rogern Exp $</font>
00003 <font class="comment"> */</font>
00004 
00005 <font class="comment">// Copyright (C) 1994 The New York Group Theory Cooperative</font>
00006 <font class="comment">// See magnus/doc/COPYRIGHT for the full notice.</font>
00007 
00008 <font class="comment">// Contents: The reference counter class for the whole project.</font>
00009 <font class="comment">//</font>
00010 <font class="comment">// Principal Author: Stephane Collart</font>
00011 <font class="comment">//</font>
00012 <font class="comment">// Status: Complete</font>
00013 <font class="comment">//</font>
00014 <font class="comment">// Questions:</font>
00015 <font class="comment">//</font>
00016 <font class="comment">// * Should some SAFETY level check for overflow of the reference</font>
00017 <font class="comment">//   count? The problem is the quite high computational cost</font>
00018 <font class="comment">//</font>
00019 <font class="comment">// * Would it ever be necessary to provide for reference counts of more than</font>
00020 <font class="comment">//   an unsigned int?</font>
00021 <font class="comment">//</font>
00022 <font class="comment">// Revision History:</font>
00023 <font class="comment">//</font>
00024 <font class="comment">// * RefCounter, as a class used purely for derivation, no longer has public</font>
00025 <font class="comment">//   members; it exports its reference count manipulators protected, so that </font>
00026 <font class="comment">//</font>
00027 
00028 <font class="preprocessor">#ifndef _REF_COUNTER_H_</font>
00029 <font class="preprocessor"></font><font class="preprocessor">#define _REF_COUNTER_H_</font>
00030 <font class="preprocessor"></font>
00031 
00032 <font class="preprocessor">#include "<a class="code" href="global_h.html">global.h</a>"</font>
00033 
00034 
<a name="l00035"></a><a class="code" href="class_RefCounter.html">00035</a> <font class="keyword">class </font><a class="code" href="class_RefCounter.html">RefCounter</a> {
00036 
00037   <font class="comment">//@rn Lippman says that this makes every instance of ObjectOf a friend,</font>
00038   <font class="comment">//@rn but gcc 2.6.3 refuses it and all obvious permutations.</font>
00039   <font class="comment">//@rn template &lt;class T&gt; friend class ObjectOf;</font>
00040   
00041 <font class="comment">//@rn Temporary kludge:</font>
00042 <font class="comment">//@rn protected:</font>
00043 <font class="keyword">public</font>:
00044 <font class="comment"></font>
00045 <font class="comment">  /////////////////////////////////////////////////////////////////////////</font>
00046 <font class="comment"></font>  <font class="comment">//                                                                     //</font>
00047   <font class="comment">// Exported Type Handles                                               //</font>
00048   <font class="comment">//                                                                     //  </font><font class="comment"></font>
00049 <font class="comment">  /////////////////////////////////////////////////////////////////////////</font>
00050 <font class="comment"></font>
<a name="l00051"></a><a class="code" href="class_RefCounter.html#s0">00051</a>   <font class="keyword">typedef</font> <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> refCounterType;
00052   <font class="comment"></font>
00053 <font class="comment">  /////////////////////////////////////////////////////////////////////////</font>
00054 <font class="comment"></font>  <font class="comment">//                                                                     //</font>
00055   <font class="comment">// Constructors                                                        //</font>
00056   <font class="comment">//                                                                     //  </font><font class="comment"></font>
00057 <font class="comment">  /////////////////////////////////////////////////////////////////////////</font>
00058 <font class="comment"></font>
<a name="l00059"></a><a class="code" href="class_RefCounter.html#a0">00059</a>   <a class="code" href="class_RefCounter.html#a0">RefCounter</a>( ) : xrefs(0) { }<font class="comment"></font>
00060 <font class="comment">  //!&lt; Default constructor</font>
00061 <font class="comment"></font><font class="comment">  /*!&lt; a new reference counter is initialised</font>
00062 <font class="comment">    with a ref count of 1 (ie 0 extra refs) */</font>
00063 
<a name="l00064"></a><a class="code" href="class_RefCounter.html#a1">00064</a>   <a class="code" href="class_RefCounter.html#a0">RefCounter</a>( <font class="keyword">const</font> <a class="code" href="class_RefCounter.html">RefCounter</a>&amp; rc ) : xrefs(0) { }<font class="comment"></font>
00065 <font class="comment">  //!&lt; Copy constructor</font>
00066 <font class="comment"></font><font class="comment">  /*!&lt; for derived representation classes whose copy constructor is generated</font>
00067 <font class="comment">   by the compiler: a new (copied) representation also has an initial</font>
00068 <font class="comment">   extra ref count of 0 */</font>
00069 
00070   <font class="comment">// Destructor provided by compiler</font>
00071 <font class="comment"></font>
00072 <font class="comment">  /////////////////////////////////////////////////////////////////////////</font>
00073 <font class="comment"></font>  <font class="comment">//                                                                     //</font>
00074   <font class="comment">// Reference Count Handles                                             //</font>
00075   <font class="comment">//                                                                     //  </font><font class="comment"></font>
00076 <font class="comment">  /////////////////////////////////////////////////////////////////////////</font>
00077 <font class="comment"></font>
<a name="l00078"></a><a class="code" href="class_RefCounter.html#a2">00078</a>   <font class="keywordtype">bool</font> <a class="code" href="class_RefCounter.html#a2">lastRef</a>( )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> xrefs == 0; }<font class="comment"></font>
00079 <font class="comment">  /*!&lt; Returns true if reference counter xrefs is 0 */</font>
00080   
<a name="l00081"></a><a class="code" href="class_RefCounter.html#a3">00081</a>   <font class="keywordtype">bool</font> <a class="code" href="class_RefCounter.html#a3">sharedRef</a>( )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> xrefs != 0; }<font class="comment"></font>
00082 <font class="comment">  /*!&lt; Returns true if reference counter xrefs is not equal to 0 */</font>
00083 
00084   
<a name="l00085"></a><a class="code" href="class_RefCounter.html#a4">00085</a>   <font class="keywordtype">void</font> <a class="code" href="class_RefCounter.html#a4">addRef</a>( )<font class="keyword"> const </font>{ ++((<a class="code" href="class_RefCounter.html">RefCounter</a>*)<font class="keyword">this</font>)-&gt;xrefs; }<font class="comment"></font>
00086 <font class="comment">  /*!&lt; Increment the reference counter.</font>
00087 <font class="comment">    addRef is logically constant */</font>
00088     
00089   
<a name="l00090"></a><a class="code" href="class_RefCounter.html#a5">00090</a>   <font class="keywordtype">void</font> <a class="code" href="class_RefCounter.html#a5">delRef</a>( )<font class="keyword"> const </font>{ --((<a class="code" href="class_RefCounter.html">RefCounter</a>*)<font class="keyword">this</font>)-&gt;xrefs; }<font class="comment"></font>
00091 <font class="comment">  /*!&lt; Decreement the reference counter.</font>
00092 <font class="comment">    delRef is logically const */</font>
00093 
00094 <font class="preprocessor">  #ifdef DEBUG</font>
00095 <font class="preprocessor"></font>  refCounterType nxrefs( )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> xrefs; }
00096 <font class="preprocessor">  #endif</font>
00097 <font class="preprocessor"></font>  
00098 <font class="keyword">private</font>:
00099   <font class="comment"></font>
00100 <font class="comment">  /////////////////////////////////////////////////////////////////////////</font>
00101 <font class="comment"></font>  <font class="comment">//                                                                     //</font>
00102   <font class="comment">// Data Members                                                        //</font>
00103   <font class="comment">//                                                                     //  </font><font class="comment"></font>
00104 <font class="comment">  /////////////////////////////////////////////////////////////////////////</font>
00105 <font class="comment"></font>
<a name="l00106"></a><a class="code" href="class_RefCounter.html#o0">00106</a>   refCounterType xrefs; <font class="comment">//!&lt; extra references (ie 0 means one ref)</font>
00107 <font class="comment"></font><font class="comment"></font>
00108 <font class="comment">  /////////////////////////////////////////////////////////////////////////</font>
00109 <font class="comment"></font>  <font class="comment">//                                                                     //</font>
00110   <font class="comment">// Hidden Members                                                      //</font>
00111   <font class="comment">//                                                                     //  </font><font class="comment"></font>
00112 <font class="comment">  /////////////////////////////////////////////////////////////////////////</font>
00113 <font class="comment"></font>
00114   <a class="code" href="class_RefCounter.html">RefCounter</a>&amp; <a class="code" href="class_RefCounter.html#c0">operator = </a>( <font class="keyword">const</font> <a class="code" href="class_RefCounter.html">RefCounter</a>&amp; );<font class="comment"></font>
00115 <font class="comment">  //!&lt; disable assignment: normally representations are never assigned</font>
00116 <font class="comment"></font>
00117 };
00118 
00119 <font class="preprocessor">#endif</font>
00120 <font class="preprocessor"></font>
</pre></div><hr><address><small>Generated at Tue Jun 19 09:49:36 2001 for Magnus Classes by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.6 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2001</small></address>
</body>
</html>
