<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>/magnus/back_end/Genetic/include/Roulette.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.6 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>/magnus/back_end/Genetic/include/Roulette.h</h1><a href="Roulette_h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="comment">//-----------------------------------------------------------</font>
00002 <font class="comment">//  FORGE</font>
00003 <font class="comment">//-----------------------------------------------------------</font>
00004 <font class="comment">//</font>
00005 <font class="comment">//      roulette.h     v1.00</font>
00006 <font class="comment">//</font>
00007 <font class="comment">//      Defines the Roulette Wheel index class</font>
00008 <font class="comment">//</font>
00009 <font class="comment">//-----------------------------------------------------------</font>
00010 <font class="comment">//  Copyright 1995 by Scott Robert Ladd. All rights reserved.</font>
00011 <font class="comment">//-----------------------------------------------------------</font>
00012 
00013 <font class="preprocessor">#ifndef FORGE_ROULETTE_H</font>
00014 <font class="preprocessor"></font><font class="preprocessor">#define FORGE_ROULETTE_H</font>
00015 <font class="preprocessor"></font>
00016 <font class="preprocessor">#include "<a class="code" href="RandomNumbers_h.html">RandomNumbers.h</a>"</font>
00017 
<a name="l00018"></a><a class="code" href="class_RW_Except.html">00018</a> <font class="keyword">class </font><a class="code" href="class_RW_Except.html">RW_Except</a> { };
00019 
00020 template &lt; class FType &gt;
<a name="l00021"></a><a class="code" href="class_RouletteWheel.html">00021</a>     <font class="keyword">class </font><a class="code" href="class_RouletteWheel.html">RouletteWheel</a>
00022         {
00023         <font class="keyword">public</font>:
00024             <font class="comment">// creation constructor</font>
00025             <a class="code" href="class_RouletteWheel.html">RouletteWheel</a>
00026                 (
00027                 size_t sz,
00028                 FType * weights = NULL,
00029                 <font class="keywordtype">int</font> seed = 0
00030                 );
00031 
00032             <font class="comment">// copy constructor</font>
00033             <a class="code" href="class_RouletteWheel.html">RouletteWheel</a>
00034                 (
00035                 <font class="keyword">const</font> <a class="code" href="class_RouletteWheel.html">RouletteWheel</a> &amp; rw
00036                 );
00037 
00038             <font class="comment">// assignment operator</font>
00039             <font class="keywordtype">void</font> <font class="keyword">operator</font> =
00040                 (
00041                 <font class="keyword">const</font> <a class="code" href="class_RouletteWheel.html">RouletteWheel</a> &amp; rw
00042                 );
00043 
00044             <font class="comment">// destructor</font>
00045             <a class="code" href="class_RouletteWheel.html#a3">~RouletteWheel</a>();
00046 
00047             <font class="comment">// change the weight of an entry</font>
00048             FType Change
00049                 (
00050                 size_t i,
00051                 FType weight
00052                 );
00053 
00054             <font class="comment">// interrogation function</font>
<a name="l00055"></a><a class="code" href="class_RouletteWheel.html#a5">00055</a>             size_t <a class="code" href="class_RouletteWheel.html#a5">GetSize</a>()<font class="keyword"> </font>{ <font class="keywordflow">return</font> N; }
00056 
00057             FType GetWeight
00058                 (
00059                 size_t i
00060                 );
00061 
00062             <font class="comment">// retrieve a random index</font>
00063             size_t <a class="code" href="class_RouletteWheel.html#a7">GetIndex</a>();
00064 
00065         <font class="keyword">protected</font>:
00066             <font class="comment">// array of weights</font>
<a name="l00067"></a><a class="code" href="class_RouletteWheel.html#n0">00067</a>             size_t  N;
<a name="l00068"></a><a class="code" href="class_RouletteWheel.html#n1">00068</a>             FType * W;
00069 
00070             <font class="comment">// total weight of all indexes</font>
<a name="l00071"></a><a class="code" href="class_RouletteWheel.html#n2">00071</a>             FType T;
00072 
00073             <font class="comment">// shared random deviate generator</font>
<a name="l00074"></a><a class="code" href="class_RouletteWheel.html#n3">00074</a>             <a class="code" href="class_UniformRandom.html">UniformRandom</a> G;
00075 
00076         <font class="keyword">private</font>:
00077             <font class="comment">// internal absolute value of a float</font>
00078             FType AbsVal
<a name="l00079"></a><a class="code" href="class_RouletteWheel.html#c0">00079</a>                 (
00080                 FType f
00081                 )
00082                 {
00083                 <font class="keywordflow">if</font> (f &lt; FType(0.0))
00084                     <font class="keywordflow">return</font> -f;
00085                 <font class="keywordflow">else</font>
00086                     <font class="keywordflow">return</font> f;
00087                 }
00088 
00089             <font class="comment">// internal copy function</font>
00090             <font class="keywordtype">void</font> Copy
00091                 (
00092                 <font class="keyword">const</font> <a class="code" href="class_RouletteWheel.html">RouletteWheel</a> &amp; rw
00093                 );
00094         };
00095 
00096 <font class="comment">// creation constructor</font>
00097 template &lt; class FType&gt;
00098     <a class="code" href="class_RouletteWheel.html">RouletteWheel&lt;FType&gt;</a>::RouletteWheel
00099         (
00100         size_t  sz,
00101         FType * weights,
00102         <font class="keywordtype">int</font> seed
00103         ) 
00104         {
00105           
00106         <font class="keywordflow">if</font>( seed != 0 )
00107           G = UniformRandom(seed);
00108 
00109         size_t i;
00110 
00111         N = sz;
00112         T = FType(0);
00113         W = <font class="keyword">new</font> FType [N];
00114 
00115         <font class="comment">//if (W == NULL) throw RW_Except();</font>
00116 
00117         <font class="keywordflow">if</font> (weights == NULL)
00118             {
00119             <font class="keywordflow">for</font> (i = 0; i &lt; N; ++i)
00120                 {
00121                 W[i] = FType(1);
00122                 T   += FType(1);
00123                 }
00124             }
00125         <font class="keywordflow">else</font>
00126             {
00127             <font class="keywordflow">for</font> (i = 0; i &lt; N; ++i)
00128                 {
00129                 W[i] = AbsVal(weights[i]);
00130                 T   += AbsVal(weights[i]);
00131                 }
00132             }
00133         }
00134 
00135 template &lt; class FType&gt;
00136     <font class="keywordtype">void</font> <a class="code" href="class_RouletteWheel.html">RouletteWheel&lt;FType&gt;</a>::Copy
00137         (
00138         <font class="keyword">const</font> <a class="code" href="class_RouletteWheel.html">RouletteWheel</a> &amp; rw
00139         )
00140         {
00141         T = rw.T;
00142         N = rw.N;
00143         W = <font class="keyword">new</font> FType [N];
00144 
00145         <font class="comment">//if (W == NULL) throw RW_Except();</font>
00146 
00147         memcpy(W,rw.W,<font class="keyword">sizeof</font>(FType) * N);
00148         }
00149 
00150 <font class="comment">// copy constructor</font>
00151 template &lt; class FType &gt;
00152     <font class="keyword">inline</font> <a class="code" href="class_RouletteWheel.html">RouletteWheel&lt;FType&gt;</a>::RouletteWheel
<a name="l00153"></a><a class="code" href="class_RouletteWheel.html#a1">00153</a>         (
00154         <font class="keyword">const</font> <a class="code" href="class_RouletteWheel.html">RouletteWheel</a> &amp; rw
00155         )
00156         {
00157         Copy(rw);
00158         }
00159 
00160 <font class="comment">// assignment operator</font>
00161 template &lt; class FType &gt;
00162     <font class="keyword">inline</font> <font class="keywordtype">void</font> <a class="code" href="class_RouletteWheel.html">RouletteWheel&lt;FType&gt;</a>::operator =
<a name="l00163"></a><a class="code" href="class_RouletteWheel.html#a2">00163</a>         (
00164         <font class="keyword">const</font> <a class="code" href="class_RouletteWheel.html">RouletteWheel</a> &amp; rw
00165         )
00166         {
00167         <font class="keyword">delete</font> [] W;
00168         Copy(rw);
00169         }
00170 
00171 <font class="comment">// destructor</font>
00172 template &lt; class FType &gt;
00173     <a class="code" href="class_RouletteWheel.html#a3">RouletteWheel&lt;FType&gt;::~RouletteWheel</a>()<font class="keyword"></font>
00174 <font class="keyword">        </font>{
00175         <font class="keyword">delete</font> [] W;
00176         }
00177 
00178 <font class="comment">// change the weight of an entry</font>
00179 template &lt; class FType &gt;
00180     FType <a class="code" href="class_RouletteWheel.html">RouletteWheel&lt;FType&gt;</a>::Change
00181         (
00182         size_t i,
00183         FType weight
00184         )
00185         {
00186         <font class="keywordflow">if</font> (i &gt;= N)
00187             <font class="keywordflow">return</font> FType(-1);
00188 
00189         T -= W[i];
00190         T += weight;
00191 
00192         FType res = W[i];
00193         W[i] = weight;
00194         <font class="keywordflow">return</font> res;
00195         }
00196 
00197 <font class="comment">// interrogator</font>
00198 template &lt; class FType &gt;
00199     <font class="keyword">inline</font> FType <a class="code" href="class_RouletteWheel.html">RouletteWheel&lt;FType&gt;</a>::GetWeight
<a name="l00200"></a><a class="code" href="class_RouletteWheel.html#a6">00200</a>         (
00201         size_t i
00202         )
00203         {
00204         <font class="keywordflow">return</font> (i &lt; N) ? W[i] : FType(-1);
00205         }
00206 
00207 <font class="comment">// retrieve a random index</font>
00208 template &lt; class FType &gt;
00209     size_t <a class="code" href="class_RouletteWheel.html#a7">RouletteWheel&lt;FType&gt;::GetIndex</a>()<font class="keyword"></font>
00210 <font class="keyword">        </font>{
00211         FType s  = FType(G.<a class="code" href="class_UniformRandom.html#a2">rand</a>() * T);
00212         size_t i = 0;
00213 
00214         <font class="keywordflow">while</font> ((i &lt; N) &amp;&amp; (s &gt; W[i]))
00215             {
00216             s -= W[i];
00217             ++i;
00218             }
00219 
00220         <font class="keywordflow">return</font> i;
00221         }
00222 
00223 <font class="preprocessor">#endif</font>
00224 <font class="preprocessor"></font>
</pre></div><hr><address><small>Generated at Tue Jun 19 09:49:36 2001 for Magnus Classes by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.6 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2001</small></address>
</body>
</html>
