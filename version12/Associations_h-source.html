<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>/magnus/back_end/general/include/Associations.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.6 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>/magnus/back_end/general/include/Associations.h</h1><a href="Associations_h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="comment">/*</font>
00002 <font class="comment"> *   $Id: Associations.h,v 1.3 2000/03/03 04:11:08 bormotov Exp $</font>
00003 <font class="comment"> */</font>
00004 
00005 <font class="comment">// Copyright (C) 1994 The New York Group Theory Cooperative</font>
00006 <font class="comment">// See magnus/doc/COPYRIGHT for the full notice.</font>
00007 
00008 <font class="comment">// Contents: Definition and implementation of</font>
00009 <font class="comment">//           template &lt;class Key, class Val&gt; class AssociationsOf</font>
00010 <font class="comment">//</font>
00011 <font class="comment">// AssociationsOf implements an associative array, currently with O(n)</font>
00012 <font class="comment">// access time.</font>
00013 <font class="comment">//</font>
00014 <font class="comment">// Principal Authors: Stephane Collart, Roger Needham</font>
00015 <font class="comment">//</font>
00016 <font class="comment">// Status: Useable.</font>
00017 <font class="comment">//</font>
00018 <font class="comment">// Revision History:</font>
00019 <font class="comment">//</font>
00020 <font class="comment">// Special remarks:</font>
00021 <font class="comment">//</font>
00022 <font class="comment">// * Requirements: Key and Val must have copy constructors and destructors,</font>
00023 <font class="comment">//   Val must have operator=, and Key must have operator==.</font>
00024 <font class="comment">//   Because an AssociationsOf method returns a ListOf&lt;Key&gt;, and ListOf wants to</font>
00025 <font class="comment">//   output its elements using &lt;&lt;, there must also be an</font>
00026 <font class="comment">//   ostream&amp; operator &lt;&lt; ( ostream&amp;, const Type&amp; ),</font>
00027 <font class="comment">//   and a conversion of Key to Type.</font>
00028 <font class="comment">//   @rn `inherited' requirements like this bear further consideration.</font>
00029 <font class="comment">//</font>
00030 <font class="comment">// * This copies Keys and Vals around, so non-user classes are less efficent.</font>
00031 <font class="comment">//</font>
00032 <font class="comment">// * The iterator template is parameterized by Key and Val, rather than</font>
00033 <font class="comment">//   container class type, so g++ 2.5.8 will buy it. We'll switch to the</font>
00034 <font class="comment">//   latter someday. Code which uses iterators will then break, but will be</font>
00035 <font class="comment">//   easy to fix.</font>
00036 <font class="comment">//</font>
00037 <font class="comment">// * Val AssociationsOf&lt;Key,Val&gt;::operator [ ] ( const Key&amp; ) const</font>
00038 <font class="comment">//   may be enhanced later to act as an lvalue. No code will break.</font>
00039 <font class="comment">//</font>
00040 <font class="comment">// * I left out the possibly handy method</font>
00041 <font class="comment">//     Key AssociationsOf&lt;Key,Val&gt;::keyOf( const Val&amp; ) const</font>
00042 <font class="comment">//   so as not to require Val to have operator==.</font>
00043 <font class="comment">//</font>
00044 <font class="comment">// * The return values of, e.g., valueOf would be more efficient as</font>
00045 <font class="comment">//   references, but that seems to make the reference count go bad.</font>
00046 <font class="comment">//   07/96 Aleksey M. implemented IPC tools</font>
00047 
00048 <font class="preprocessor">#ifndef _ASSOCIATIONS_H_</font>
00049 <font class="preprocessor"></font><font class="preprocessor">#define _ASSOCIATIONS_H_</font>
00050 <font class="preprocessor"></font>
00051 
00052 <font class="preprocessor">#include "<a class="code" href="RefCounter_h.html">RefCounter.h</a>"</font>
00053 <font class="preprocessor">#include "<a class="code" href="ObjectOf_h.html">ObjectOf.h</a>"</font>
00054 <font class="preprocessor">#include "<a class="code" href="List_h.html">List.h</a>"</font>
00055 <font class="preprocessor">#include "<a class="code" href="Cell_h.html">Cell.h</a>"</font>
00056 
00057 <font class="preprocessor">#include &lt;iostream.h&gt;</font>
00058 
00059 
00060 <font class="comment">//---------------------- class Association ----------------------------------</font>
00061 
<a name="l00062"></a><a class="code" href="class_Association.html">00062</a> template &lt;class Key, class Val&gt; <font class="keyword">class </font><a class="code" href="class_Association.html">Association</a> {
00063 <font class="keyword">public</font>:
<a name="l00064"></a><a class="code" href="class_Association.html#a0">00064</a>   <a class="code" href="class_Association.html#a0">Association</a>(Key k, Val v) : key(k), val(v) { }
<a name="l00065"></a><a class="code" href="class_Association.html#m0">00065</a>   Key key;
<a name="l00066"></a><a class="code" href="class_Association.html#m1">00066</a>   Val val;
00067  <font class="comment"></font>
00068 <font class="comment"> /////////////////////////////////////////////////////////////////////////</font>
00069 <font class="comment"></font>  <font class="comment">//                                                                     //</font>
00070   <font class="comment">// IPC tools:                                                          //</font>
00071   <font class="comment">//                                                                     //</font><font class="comment"></font>
00072 <font class="comment">  /////////////////////////////////////////////////////////////////////////</font>
00073 <font class="comment"></font>
<a name="l00074"></a><a class="code" href="class_Association.html#l0">00074</a>   <font class="keyword">friend</font> ostream&amp; <a class="code" href="class_Association.html#l0">operator &lt; </a>( ostream&amp; ostr, <font class="keyword">const</font> <a class="code" href="class_Association.html">Association</a>&amp; A )<font class="keyword"></font>
00075 <font class="keyword">  </font>{
00076     ostr &lt; A.key;
00077     ostr &lt; A.val;
00078     <font class="keywordflow">return</font> ostr;
00079   }
00080   
<a name="l00081"></a><a class="code" href="class_Association.html#l1">00081</a>   <font class="keyword">friend</font> istream&amp; <a class="code" href="class_Association.html#l1">operator &gt; </a>( istream&amp; istr, <a class="code" href="class_Association.html">Association</a>&amp; A )<font class="keyword"></font>
00082 <font class="keyword">  </font>{
00083     istr &gt; A.key;
00084     istr &gt; A.val;
00085     <font class="keywordflow">return</font> istr;
00086   }
00087 
00088 };
00089 
00090 <font class="comment">//---------------------- class AssociationsRep -----------------------------</font>
00091 
00092 
00093 template &lt;class Key, class Val&gt; <font class="keyword">class </font><a class="code" href="class_AssociationsIteratorRep.html">AssociationsIteratorRep</a>;
00094 <font class="comment">// Forward declaration for friend declarations.</font>
00095 
<a name="l00096"></a><a class="code" href="class_AssociationsRep.html">00096</a> template &lt;class Key, class Val&gt; <font class="keyword">class </font><a class="code" href="class_AssociationsRep.html">AssociationsRep</a> : <font class="keyword">public</font> <a class="code" href="class_RefCounter.html">RefCounter</a> {
00097 
00098 <font class="keyword">public</font>:
00099 
<a name="l00100"></a><a class="code" href="class_AssociationsRep.html#a0">00100</a>   <a class="code" href="class_AssociationsRep.html#a0">AssociationsRep</a>( ) : theList(NULL), theCardinality(0) {}
00101 
<a name="l00102"></a><a class="code" href="class_AssociationsRep.html#a1">00102</a>   <a class="code" href="class_AssociationsRep.html#a0">AssociationsRep</a>( <font class="keyword">const</font> <a class="code" href="class_AssociationsRep.html">AssociationsRep</a>&amp; ar )<font class="keyword"> </font>{  <font class="comment">// Usual deep copy.</font>
00103     theCardinality = ar.theCardinality;
00104     theList = NULL;
00105     <a class="code" href="class_Cell.html">CellType</a>* tmpList = NULL;
00106     <a class="code" href="class_Cell.html">CellType</a>* oldList = ar.theList;
00107     <font class="keywordflow">while</font> ( oldList ) {
00108       <font class="keywordflow">if</font> ( theList == NULL ) {
00109         theList = <font class="keyword">new</font> <a class="code" href="class_AssociationsRep.html#u0">CellType</a>(*oldList);
00110         tmpList = theList;
00111       } <font class="comment">// @stc are you relying on the compiler to move this out of</font>
00112       <font class="comment">// the loop?</font>
00113       <font class="keywordflow">else</font> {
00114         tmpList-&gt;nextCell = <font class="keyword">new</font> <a class="code" href="class_AssociationsRep.html#u0">CellType</a>(*oldList);
00115         tmpList = tmpList-&gt;nextCell;
00116       }
00117       oldList = oldList-&gt;nextCell;
00118     }
00119     <font class="keywordflow">if</font>( tmpList )
00120       tmpList-&gt;nextCell = NULL; <font class="comment">// Better safe than sorry</font>
00121   }
00122 
<a name="l00123"></a><a class="code" href="class_AssociationsRep.html#a2">00123</a>   <a class="code" href="class_AssociationsRep.html#a2">~AssociationsRep</a>( )<font class="keyword"> </font>{
00124          <font class="keywordflow">while</font> ( theList ) {
00125                 <a class="code" href="class_Cell.html">CellType</a>* tmpList = theList;
00126                 theList = theList-&gt;nextCell;
00127                 <font class="keyword">delete</font> tmpList;
00128          }
00129   }
00130   
<a name="l00131"></a><a class="code" href="class_AssociationsRep.html#a3">00131</a>   <a class="code" href="class_AssociationsRep.html">AssociationsRep</a>* <a class="code" href="class_AssociationsRep.html#a3">clone</a>( )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> <font class="keyword">new</font> <a class="code" href="class_AssociationsRep.html#a0">AssociationsRep</a>(*<font class="keyword">this</font>); }
00132 
<a name="l00133"></a><a class="code" href="class_AssociationsRep.html#a4">00133</a>   <font class="keywordtype">void</font> <a class="code" href="class_AssociationsRep.html#a4">unbind</a>( <font class="keyword">const</font> Key&amp; k )<font class="keyword"> </font>{
00134          <font class="keywordflow">if</font> ( theList-&gt;<a class="code" href="class_Cell.html#a6">getContents</a>().key == k ) {
00135                 <a class="code" href="class_Cell.html">CellType</a>* tmp = theList;
00136                 theList = theList-&gt;nextCell;
00137                 <font class="keyword">delete</font> tmp;
00138                 --theCardinality;
00139          } <font class="keywordflow">else</font> {
00140                 <a class="code" href="class_Cell.html">CellType</a>* pred = theList;
00141                 <a class="code" href="class_Cell.html">CellType</a>* scan = theList-&gt;nextCell;
00142                 <font class="keywordflow">while</font> ( scan ) {
00143                   <font class="keywordflow">if</font> ( scan-&gt;<a class="code" href="class_Cell.html#a6">getContents</a>().key == k ) {
00144                          pred-&gt;nextCell = scan-&gt;nextCell;
00145                          <font class="keyword">delete</font> scan;
00146                          --theCardinality;
00147                          <font class="keywordflow">break</font>;
00148                   }
00149                   scan = scan-&gt;nextCell;
00150                 }
00151          }
00152   }
00153 
<a name="l00154"></a><a class="code" href="class_AssociationsRep.html#a5">00154</a>   <font class="keywordtype">void</font> <a class="code" href="class_AssociationsRep.html#a5">bind</a>( <font class="keyword">const</font> Key&amp; k, <font class="keyword">const</font> Val&amp; v )<font class="keyword"> </font>{
00155          <a class="code" href="class_Cell.html">CellType</a>* where = <a class="code" href="class_AssociationsRep.html#c1">seek</a>(k);
00156          <font class="keywordflow">if</font> ( where )
00157                 where-&gt;<a class="code" href="class_Cell.html#a6">getContents</a>().val = v;
00158          <font class="keywordflow">else</font> {
00159                 <font class="comment">//@rn g++2.5.8 can get confused by:</font>
00160                 <font class="comment">// theList = new CellType(Association&lt;Key,Val&gt;(k, v), theList);</font>
00161 
00162                 <a class="code" href="class_Cell.html">CellType</a>* tmp = <font class="keyword">new</font> <a class="code" href="class_AssociationsRep.html#u0">CellType</a>(<a class="code" href="class_Association.html">Association&lt;Key,Val&gt;</a>(k, v));
00163                 tmp-&gt;nextCell = theList;
00164                 theList = tmp;
00165                 ++theCardinality;
00166          }
00167   }
00168 
<a name="l00169"></a><a class="code" href="class_AssociationsRep.html#a6">00169</a>   Val <a class="code" href="class_AssociationsRep.html#a6">val</a>( <font class="keyword">const</font> Key&amp; k )<font class="keyword"> const </font>{
00170          <a class="code" href="class_Cell.html">CellType</a>* where = <a class="code" href="class_AssociationsRep.html#c1">seek</a>(k);
00171 <font class="preprocessor">    #if SAFETY &gt; 0</font>
00172 <font class="preprocessor"></font>           <font class="keywordflow">if</font> ( where == NULL )
00173         <a class="code" href="error_h.html#a0">error</a>(<font class="stringliteral">"called AssociationsOf&lt;Key,Val&gt;::operator [ ] with unbound Key"</font>);
00174 <font class="preprocessor">    #endif</font>
00175 <font class="preprocessor"></font>         <font class="keywordflow">return</font> where-&gt;<a class="code" href="class_Cell.html#a6">getContents</a>().val;
00176   }
00177 
<a name="l00178"></a><a class="code" href="class_AssociationsRep.html#a7">00178</a>   Bool <a class="code" href="class_AssociationsRep.html#a7">bound</a>( <font class="keyword">const</font> Key&amp; k )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> (<a class="code" href="class_AssociationsRep.html#c1">seek</a>(k) != NULL); }
00179 
<a name="l00180"></a><a class="code" href="class_AssociationsRep.html#a8">00180</a>   <font class="keywordtype">int</font> <a class="code" href="class_AssociationsRep.html#a8">cardinality</a>()<font class="keyword"> const </font>{ 
00181     <font class="keywordflow">return</font> theCardinality;
00182   }
00183 <font class="comment"></font>
00184 <font class="comment">  /////////////////////////////////////////////////////////////////////////</font>
00185 <font class="comment"></font>  <font class="comment">//                                                                     //</font>
00186   <font class="comment">// IPC tools:                                                          //</font>
00187   <font class="comment">//                                                                     //</font><font class="comment"></font>
00188 <font class="comment">  /////////////////////////////////////////////////////////////////////////</font>
00189 <font class="comment"></font>
00190   <font class="keywordtype">void</font>  <a class="code" href="class_AssociationsRep.html#a9">write</a>( ostream&amp; ostr ) <font class="keyword">const</font>;
00191   <font class="keywordtype">void</font>  <a class="code" href="class_AssociationsRep.html#a10">read</a>( istream&amp; istr );
00192 
00193 
00194 <font class="keyword">private</font>:
00195 
<a name="l00196"></a><a class="code" href="class_AssociationsRep.html#u0">00196</a>   <font class="keyword">typedef</font> <a class="code" href="class_Cell.html">Cell&lt; Association&lt;Key,Val&gt;</a> &gt; <a class="code" href="class_Cell.html">CellType</a>;
00197 
<a name="l00198"></a><a class="code" href="class_AssociationsRep.html#l0">00198</a>   <font class="keyword">friend</font> <font class="keyword">class </font><a class="code" href="class_AssociationsIteratorRep.html">AssociationsIteratorRep</a>&lt;Key,Val&gt;;
00199 
<a name="l00200"></a><a class="code" href="class_AssociationsRep.html#c0">00200</a>   <a class="code" href="class_AssociationsRep.html#a0">AssociationsRep</a>(<a class="code" href="class_Cell.html">CellType</a>* L)<font class="keyword"> </font>{ theList = L; }
00201 
<a name="l00202"></a><a class="code" href="class_AssociationsRep.html#c1">00202</a>   <a class="code" href="class_Cell.html">CellType</a>* <a class="code" href="class_AssociationsRep.html#c1">seek</a>( <font class="keyword">const</font> Key&amp; k )<font class="keyword"> const </font>{
00203          <a class="code" href="class_Cell.html">CellType</a>* scan = theList;
00204          <font class="keywordflow">while</font> ( scan ) {
00205                 <font class="keywordflow">if</font> ( scan-&gt;<a class="code" href="class_Cell.html#a6">getContents</a>().key == k ) <font class="keywordflow">return</font> scan;
00206                 scan = scan-&gt;nextCell;
00207          }
00208          <font class="keywordflow">return</font> NULL;
00209   }
00210 
00211   <font class="comment">// Data members:</font>
00212 
<a name="l00213"></a><a class="code" href="class_AssociationsRep.html#o0">00213</a>   <a class="code" href="class_Cell.html">CellType</a>* theList;
<a name="l00214"></a><a class="code" href="class_AssociationsRep.html#o1">00214</a>   <font class="keywordtype">int</font> theCardinality;
00215 };
00216 
00217 
00218 <font class="comment">//------------------- class AssociationsOf --------------------------//</font>
00219 
00220 
00221 template &lt;class Key, class Val&gt; <font class="keyword">struct </font><a class="code" href="struct_AssocRef.html">AssocRef</a>;
00222 
00223 template &lt;class Key, class Val&gt;
<a name="l00224"></a><a class="code" href="class_AssociationsOf.html">00224</a> <font class="keyword">class </font><a class="code" href="class_AssociationsOf.html">AssociationsOf</a> : <font class="keyword">public</font> <a class="code" href="class_ObjectOf.html">ObjectOf</a>&lt; AssociationsRep&lt;Key,Val&gt; &gt; {
00225 
00226 <font class="keyword">public</font>:
00227 
<a name="l00228"></a><a class="code" href="class_AssociationsOf.html#a0">00228</a>   <a class="code" href="class_AssociationsOf.html#a0">AssociationsOf</a>( ) : <a class="code" href="class_ObjectOf.html">ObjectOf</a>&lt;<a class="code" href="struct_VectorPtrRep.html">Rep</a>&gt;(new <a class="code" href="struct_VectorPtrRep.html">Rep</a>()) { }
00229   <font class="comment">// Default constructor makes an empty set of associations.</font>
00230 
00231   <font class="comment">// Copy constructor, operator=, and destructor supplied by compiler.</font>
00232 
<a name="l00233"></a><a class="code" href="class_AssociationsOf.html#a1">00233</a>   Val <a class="code" href="class_AssociationsOf.html#a1">operator [ ] </a>( <font class="keyword">const</font> Key&amp; k )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> <a class="code" href="class_AssociationsOf.html#a3">valueOf</a>(k); }
00234   <font class="comment">// Operator synonym for valueOf.</font>
00235 
00236   <a class="code" href="struct_AssocRef.html">AssocRef&lt;Key,Val&gt;</a> <a class="code" href="class_AssociationsOf.html#a1">operator [ ] </a>( <font class="keyword">const</font> Key&amp; k );
00237 
<a name="l00238"></a><a class="code" href="class_AssociationsOf.html#a3">00238</a>   Val <a class="code" href="class_AssociationsOf.html#a3">valueOf</a>( <font class="keyword">const</font> Key&amp; k )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> <a class="code" href="class_ObjectOf.html#b0">look</a>()-&gt;val(k); }
00239   <font class="comment">// Retrieves the Val associated with k. It is a fatal error if k is not</font>
00240   <font class="comment">// bound to any Val.</font>
00241 
<a name="l00242"></a><a class="code" href="class_AssociationsOf.html#a4">00242</a>   <font class="keywordtype">void</font> <a class="code" href="class_AssociationsOf.html#a4">bind</a>( <font class="keyword">const</font> Key&amp; k, <font class="keyword">const</font> Val&amp; v )<font class="keyword"> </font>{ <a class="code" href="class_ObjectOf.html#b2">change</a>()-&gt;bind(k, v); }
00243   <font class="comment">// Associates k with v. Overwrites any existing association.</font>
00244 
<a name="l00245"></a><a class="code" href="class_AssociationsOf.html#a5">00245</a>   <font class="keywordtype">void</font> <a class="code" href="class_AssociationsOf.html#a5">unbind</a>( <font class="keyword">const</font> Key&amp; k )<font class="keyword"> </font>{ <a class="code" href="class_ObjectOf.html#b2">change</a>()-&gt;unbind(k); }
00246   <font class="comment">// Breaks any association k has; not an error if none.</font>
00247 
<a name="l00248"></a><a class="code" href="class_AssociationsOf.html#a6">00248</a>   Bool <a class="code" href="class_AssociationsOf.html#a6">bound</a>( <font class="keyword">const</font> Key&amp; k )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> <a class="code" href="class_ObjectOf.html#b0">look</a>()-&gt;bound(k); }
00249   <font class="comment">// Says whether k is associated with anything.</font>
00250 
00251   <a class="code" href="class_ListOf.html">ListOf&lt;Key&gt;</a> <a class="code" href="class_AssociationsOf.html#a7">keys</a>( ) <font class="keyword">const</font>;
00252   <font class="comment">// Returns a list of all keys in this association list.</font>
00253   <font class="comment">// A similar function returning all values would require Val to</font>
00254   <font class="comment">// have an operator==.</font>
00255 
<a name="l00256"></a><a class="code" href="class_AssociationsOf.html#a8">00256</a>   <font class="keywordtype">int</font> <a class="code" href="class_AssociationsOf.html#a8">cardinality</a>()<font class="keyword"> const </font>{ <font class="keywordflow">return</font> <a class="code" href="class_ObjectOf.html#b0">look</a>()-&gt;cardinality(); }
00257 <font class="comment"></font>
00258 <font class="comment">  /////////////////////////////////////////////////////////////////////////</font>
00259 <font class="comment"></font>  <font class="comment">//                                                                     //</font>
00260   <font class="comment">// IPC tools:                                                          //</font>
00261   <font class="comment">//                                                                     //</font><font class="comment"></font>
00262 <font class="comment">  /////////////////////////////////////////////////////////////////////////</font>
00263 <font class="comment"></font>
<a name="l00264"></a><a class="code" href="class_AssociationsOf.html#l1">00264</a>   <font class="keyword">friend</font> ostream&amp; <a class="code" href="Polynomial_h.html#a2">operator &lt; </a>( ostream&amp; ostr, <font class="keyword">const</font> <a class="code" href="class_AssociationsOf.html">AssociationsOf</a>&amp; A )<font class="keyword"></font>
00265 <font class="keyword">  </font>{
00266     A.<a class="code" href="class_ObjectOf.html#b0">look</a>()-&gt;write(ostr);
00267     <font class="keywordflow">return</font> ostr;
00268   }
00269   
<a name="l00270"></a><a class="code" href="class_AssociationsOf.html#l2">00270</a>   <font class="keyword">friend</font> istream&amp; <a class="code" href="Polynomial_h.html#a3">operator &gt; </a>( istream&amp; istr, <a class="code" href="class_AssociationsOf.html">AssociationsOf</a>&amp; A)<font class="keyword"></font>
00271 <font class="keyword">  </font>{
00272     A.<a class="code" href="class_ObjectOf.html#b2">change</a>()-&gt;read(istr);
00273     <font class="keywordflow">return</font> istr;
00274   }
00275 
00276 <font class="keyword">private</font>:
00277 
<a name="l00278"></a><a class="code" href="class_AssociationsOf.html#u0">00278</a>   <font class="keyword">typedef</font> <a class="code" href="class_AssociationsRep.html">AssociationsRep&lt;Key,Val&gt;</a> <a class="code" href="struct_VectorPtrRep.html">Rep</a>;
00279 
<a name="l00280"></a><a class="code" href="class_AssociationsOf.html#l0">00280</a>   <font class="keyword">friend</font> <font class="keyword">class </font><a class="code" href="class_AssociationsIteratorRep.html">AssociationsIteratorRep</a>&lt;Key,Val&gt;;
00281 };
00282 
00283 
00284 <font class="comment">//------------------------ struct AssocRef ---------------------------//</font>
00285 
00286 
<a name="l00287"></a><a class="code" href="struct_AssocRef.html">00287</a> template &lt;class Key, class Val&gt; <font class="keyword">struct </font><a class="code" href="struct_AssocRef.html">AssocRef</a> {
<a name="l00288"></a><a class="code" href="struct_AssocRef.html#m0">00288</a>         <a class="code" href="class_AssociationsOf.html">AssociationsOf&lt;Key,Val&gt;</a>&amp; asref;
<a name="l00289"></a><a class="code" href="struct_AssocRef.html#m1">00289</a>         <font class="keyword">const</font> Key key;
<a name="l00290"></a><a class="code" href="struct_AssocRef.html#a0">00290</a>         <a class="code" href="struct_AssocRef.html#a0">AssocRef</a>( <a class="code" href="class_AssociationsOf.html">AssociationsOf&lt;Key,Val&gt;</a>&amp; a, <font class="keyword">const</font> Key&amp; k ) : asref(a), key(k) { }
<a name="l00291"></a><a class="code" href="struct_AssocRef.html#a1">00291</a>    <font class="keyword">const</font> Val&amp; <a class="code" href="class_ObjectOf.html#a2">operator = </a>( <font class="keyword">const</font> Val&amp; val )<font class="keyword"></font>
00292 <font class="keyword">                </font>{ asref.<a class="code" href="class_AssociationsOf.html#a4">bind</a>(key,val); <font class="keywordflow">return</font> val; }
<a name="l00293"></a><a class="code" href="struct_AssocRef.html#a2">00293</a>         <a class="code" href="struct_AssocRef.html#a2">operator Val </a>( )<font class="keyword"> </font>{ <font class="keywordflow">return</font> asref.<a class="code" href="class_AssociationsOf.html#a3">valueOf</a>(key); }
<a name="l00294"></a><a class="code" href="struct_AssocRef.html#a3">00294</a>         <a class="code" href="struct_AssocRef.html#a3">operator void* </a>( )<font class="keyword"> </font>{ <font class="keywordflow">return</font> (<font class="keywordtype">void</font>*)asref.<a class="code" href="class_AssociationsOf.html#a6">bound</a>(key); }
00295 };
00296 
00297 
00298 <font class="comment">//------------------------ AssociationsOf ---------------------------//</font>
00299 <font class="comment">//---------------------- inline functions ---------------------------//</font>
00300 
00301 template &lt;class Key, class Val&gt;
<a name="l00302"></a><a class="code" href="class_AssociationsOf.html#a2">00302</a> <font class="keyword">inline</font> <a class="code" href="struct_AssocRef.html">AssocRef&lt;Key,Val&gt;</a> <a class="code" href="class_AssociationsOf.html#a1">AssociationsOf&lt;Key,Val&gt;::operator [ ] </a>( <font class="keyword">const</font> Key&amp; k )<font class="keyword"></font>
00303 <font class="keyword">        </font>{ <font class="keywordflow">return</font> <a class="code" href="struct_AssocRef.html">AssocRef&lt;Key,Val&gt;</a>(*<font class="keyword">this</font>,k); }
00304 
00305 
00306 <font class="comment">//-------------- class AssociationsIteratorRep ----------------------//</font>
00307 
00308 template &lt;class Key, class Val&gt;
<a name="l00309"></a><a class="code" href="class_AssociationsIteratorRep.html">00309</a> <font class="keyword">class </font><a class="code" href="class_AssociationsIteratorRep.html">AssociationsIteratorRep</a> : <font class="keyword">public</font> <a class="code" href="class_RefCounter.html">RefCounter</a> {
00310 
00311 <font class="keyword">public</font>:
00312 
<a name="l00313"></a><a class="code" href="class_AssociationsIteratorRep.html#a0">00313</a>   <a class="code" href="class_AssociationsIteratorRep.html#a0">AssociationsIteratorRep</a>( <font class="keyword">const</font> <a class="code" href="class_AssociationsOf.html">AssociationsOf&lt;Key,Val&gt;</a>&amp; A ) :
00314     theAssociations(A) {
00315          current = theAssociations.<a class="code" href="class_ObjectOf.html#b0">look</a>()-&gt;theList;
00316   }
00317 
00318   <font class="comment">// Use compiler's copy constructor, operator=, and destructor.</font>
00319 
<a name="l00320"></a><a class="code" href="class_AssociationsIteratorRep.html#a1">00320</a>   <a class="code" href="class_AssociationsIteratorRep.html">AssociationsIteratorRep</a> *<a class="code" href="class_AssociationsIteratorRep.html#a1">clone</a>()<font class="keyword"> const </font>{
00321          <font class="keywordflow">return</font> <font class="keyword">new</font> <a class="code" href="class_AssociationsIteratorRep.html#a0">AssociationsIteratorRep</a>(*<font class="keyword">this</font>);
00322   }
00323 
<a name="l00324"></a><a class="code" href="class_AssociationsIteratorRep.html#a2">00324</a>   Bool <a class="code" href="Property_h.html#a1">operator == </a>( <font class="keyword">const</font> <a class="code" href="class_AssociationsIteratorRep.html">AssociationsIteratorRep</a>&amp; <a class="code" href="class_AssociationsIteratorRep.html">AIR</a> )<font class="keyword"> const </font>{
00325          <font class="keywordflow">return</font> ( ( current == <a class="code" href="class_AssociationsIteratorRep.html">AIR</a>.current ) &amp;&amp; 
00326                                  ( theAssociations.<a class="code" href="class_ObjectOf.html#b0">look</a>() == <a class="code" href="class_AssociationsIteratorRep.html">AIR</a>.theAssociations.<a class="code" href="class_ObjectOf.html#b0">look</a>() ) );
00327   }
00328   <font class="comment">// @rn compare theAssociations cell-by-cell?</font>
00329   <font class="comment">// We do not want logical == of theAssociations, since iteration order</font>
00330   <font class="comment">// would be different.</font>
00331 
<a name="l00332"></a><a class="code" href="class_AssociationsIteratorRep.html#a3">00332</a>   Key <a class="code" href="class_AssociationsIteratorRep.html#a3">key</a>( )<font class="keyword"> const </font>{
00333 <font class="preprocessor">         #if SAFETY &gt; 0</font>
00334 <font class="preprocessor"></font>           <font class="keywordflow">if</font> ( current == NULL )
00335                   <a class="code" href="error_h.html#a0">error</a>(<font class="stringliteral">"tried to retrieve key from AssociationsIterator which is done"</font>);
00336 <font class="preprocessor">    #endif</font>
00337 <font class="preprocessor"></font>         <font class="keywordflow">return</font> current-&gt;getContents().key;
00338   }
00339 
<a name="l00340"></a><a class="code" href="class_AssociationsIteratorRep.html#a4">00340</a>   Val <a class="code" href="class_AssociationsIteratorRep.html#a4">value</a>( )<font class="keyword"> const </font>{
00341 <font class="preprocessor">         #if SAFETY &gt; 0</font>
00342 <font class="preprocessor"></font>           <font class="keywordflow">if</font> ( current == NULL )
00343         <a class="code" href="error_h.html#a0">error</a>(<font class="stringliteral">"tried to retrieve value from AssociationsIterator which is done"</font>);
00344 <font class="preprocessor">    #endif</font>
00345 <font class="preprocessor"></font>         <font class="keywordflow">return</font> current-&gt;getContents().val;
00346   }
00347 
<a name="l00348"></a><a class="code" href="class_AssociationsIteratorRep.html#a5">00348</a>   Bool <a class="code" href="class_AssociationsIteratorRep.html#a5">next</a>( )<font class="keyword"> </font>{
00349          <font class="keywordflow">if</font> ( current != NULL )
00350                 current = current-&gt;nextCell;
00351          <font class="keywordflow">return</font> (current != NULL);
00352   }
00353 
<a name="l00354"></a><a class="code" href="class_AssociationsIteratorRep.html#a6">00354</a>   Bool <a class="code" href="class_AssociationsIteratorRep.html#a6">done</a>( )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> (current == NULL); }
00355 
<a name="l00356"></a><a class="code" href="class_AssociationsIteratorRep.html#a7">00356</a>   <font class="keywordtype">void</font> <a class="code" href="class_AssociationsIteratorRep.html#a7">reset</a>( )<font class="keyword"> </font>{ current = theAssociations.<a class="code" href="class_ObjectOf.html#b0">look</a>()-&gt;theList; }
00357 <font class="comment"></font>
00358 <font class="comment"> /////////////////////////////////////////////////////////////////////////</font>
00359 <font class="comment"></font>  <font class="comment">//                                                                     //</font>
00360   <font class="comment">// IPC tools:                                                          //</font>
00361   <font class="comment">//                                                                     //</font><font class="comment"></font>
00362 <font class="comment">  /////////////////////////////////////////////////////////////////////////</font>
00363 <font class="comment"></font>
00364   <font class="keywordtype">void</font>  <a class="code" href="class_AssociationsIteratorRep.html#a8">write</a>( ostream&amp; ostr ) <font class="keyword">const</font>;
00365   <font class="keywordtype">void</font>  <a class="code" href="class_AssociationsIteratorRep.html#a9">read</a>( istream&amp; istr );
00366 
00367 <font class="keyword">private</font>:
00368 
00369   <font class="comment">// Data members:</font>
00370 
<a name="l00371"></a><a class="code" href="class_AssociationsIteratorRep.html#o0">00371</a>   <font class="keyword">const</font> <a class="code" href="class_AssociationsOf.html">AssociationsOf&lt;Key,Val&gt;</a>&amp; theAssociations;
00372 
<a name="l00373"></a><a class="code" href="class_AssociationsIteratorRep.html#o1">00373</a>   <a class="code" href="class_AssociationsRep.html">AssociationsRep&lt;Key,Val&gt;</a>::CellType* current;
00374 };
00375 
00376 
00377 <font class="comment">//---------------------- class AssociationsIterator ---------------------------</font>
00378 
00379 
00380 <font class="comment">// Example of use:</font>
00381 <font class="comment">//</font>
00382 <font class="comment">//  AssociationsOf&lt;Chars,Word&gt; wordTable;</font>
00383 <font class="comment">//  Word w;</font>
00384 <font class="comment">//  ...</font>
00385 <font class="comment">//</font>
00386 <font class="comment">//  // Remove all associations with w from wordTable:</font>
00387 <font class="comment">//  </font>
00388 <font class="comment">//  AssociationsIterator&lt;Chars,Word&gt; I(wordTable);</font>
00389 <font class="comment">//  </font>
00390 <font class="comment">//  while ( !I.done() ) {</font>
00391 <font class="comment">//    if ( I.value() == G ) wordTable.unbind( I.key() );</font>
00392 <font class="comment">//    I.next();</font>
00393 <font class="comment">//  }</font>
00394 
00395 <font class="comment">// Note: You may alter the AssociationsOf over which you are iterating,</font>
00396 <font class="comment">//       but the iterator uses the `old' copy.</font>
00397 
00398 template &lt;class Key, class Val&gt;
<a name="l00399"></a><a class="code" href="class_AssociationsIterator.html">00399</a> <font class="keyword">class </font><a class="code" href="class_AssociationsIterator.html">AssociationsIterator</a> :
00400 <font class="keyword">public</font> <a class="code" href="class_ObjectOf.html">ObjectOf</a>&lt; AssociationsIteratorRep&lt;Key,Val&gt; &gt; {
00401 
00402 <font class="keyword">public</font>:
00403 
<a name="l00404"></a><a class="code" href="class_AssociationsIterator.html#a0">00404</a>   <a class="code" href="class_AssociationsIterator.html#a0">AssociationsIterator</a>(<font class="keyword">const</font> <a class="code" href="class_AssociationsOf.html">AssociationsOf&lt;Key,Val&gt;</a>&amp; A) :
00405     <a class="code" href="class_ObjectOf.html">ObjectOf</a>&lt;<a class="code" href="class_AssociationsIteratorRep.html">AIR</a>&gt;( new <a class="code" href="class_AssociationsIteratorRep.html">AIR</a>(A) ) { }
00406   <font class="comment">// Initialize an iterator with the Associations over which to iterate.</font>
00407 
00408   <font class="comment">// Copy constructor, operator=, and destructor supplied by compiler.</font>
00409 
00410   <font class="comment">// Copying or assigning an iterator is guaranteed to produce an</font>
00411   <font class="comment">// iterator which visits the (rest of the) same elements in the</font>
00412   <font class="comment">// same order as the original.</font>
00413 
<a name="l00414"></a><a class="code" href="class_AssociationsIterator.html#a1">00414</a>   Bool <a class="code" href="Property_h.html#a1">operator == </a>( <font class="keyword">const</font> <a class="code" href="class_AssociationsIterator.html">AssociationsIterator</a>&amp; I )<font class="keyword"> const </font>{
00415          <font class="keywordflow">return</font> ((<a class="code" href="class_ObjectOf.html#b0">look</a>() == I.<a class="code" href="class_ObjectOf.html#b0">look</a>()) || (*<a class="code" href="class_ObjectOf.html#b0">look</a>() == *I.<a class="code" href="class_ObjectOf.html#b0">look</a>()));
00416   }
00417 
<a name="l00418"></a><a class="code" href="class_AssociationsIterator.html#a2">00418</a>   Key <a class="code" href="class_AssociationsIterator.html#a2">key</a>( )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> <a class="code" href="class_ObjectOf.html#b0">look</a>()-&gt;key(); }
00419   <font class="comment">// Returns key of current association. Calling this is a fatal error</font>
00420   <font class="comment">// if done().</font>
00421 
<a name="l00422"></a><a class="code" href="class_AssociationsIterator.html#a3">00422</a>   Val <a class="code" href="class_AssociationsIterator.html#a3">value</a>( )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> <a class="code" href="class_ObjectOf.html#b0">look</a>()-&gt;value(); }
00423   <font class="comment">// Returns value of current association. Calling this is a fatal error</font>
00424   <font class="comment">// if done().</font>
00425 
<a name="l00426"></a><a class="code" href="class_AssociationsIterator.html#a4">00426</a>   Bool <a class="code" href="class_AssociationsIterator.html#a4">next</a>( )<font class="keyword"> </font>{ <font class="keywordflow">return</font> <a class="code" href="class_ObjectOf.html#b2">change</a>()-&gt;next(); }
00427   <font class="comment">// Advances this iterator.</font>
00428   <font class="comment">// Returns TRUE iff the iteration has not finished.</font>
00429   <font class="comment">// This may be called after it returns FALSE with no side effect.</font>
00430 
<a name="l00431"></a><a class="code" href="class_AssociationsIterator.html#a5">00431</a>   Bool <a class="code" href="class_AssociationsIterator.html#a5">done</a>( )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> <a class="code" href="class_ObjectOf.html#b0">look</a>()-&gt;done(); }
00432   <font class="comment">// Returns TRUE iff the iteration has finished. This may</font>
00433   <font class="comment">// be called after it returns TRUE with no side effect.</font>
00434 
<a name="l00435"></a><a class="code" href="class_AssociationsIterator.html#a6">00435</a>   <font class="keywordtype">void</font> <a class="code" href="class_AssociationsIterator.html#a6">reset</a>( )<font class="keyword"> </font>{ <a class="code" href="class_ObjectOf.html#b2">change</a>()-&gt;reset(); }
00436   <font class="comment">// Resets this iterator to the state it was in after construction.</font>
00437 
00438   <font class="comment">// @stc the following are added as a tentative supplementary</font>
00439   <font class="comment">// convenience</font>
<a name="l00440"></a><a class="code" href="class_AssociationsIterator.html#a7">00440</a>     <a class="code" href="class_AssociationsIterator.html">AssociationsIterator</a>&amp; <a class="code" href="class_AssociationsIterator.html#a7">operator ++ </a>( )<font class="keyword"> </font>{ <a class="code" href="class_AssociationsIterator.html#a4">next</a>(); <font class="keywordflow">return</font> *<font class="keyword">this</font>; }
<a name="l00441"></a><a class="code" href="class_AssociationsIterator.html#a8">00441</a>     <a class="code" href="class_AssociationsIterator.html">AssociationsIterator</a> <a class="code" href="class_AssociationsIterator.html#a7">operator ++ </a>( <font class="keywordtype">int</font> )<font class="keyword"> </font>{
00442         <a class="code" href="class_AssociationsIterator.html">AssociationsIterator</a> old = *<font class="keyword">this</font>;
00443         <a class="code" href="class_AssociationsIterator.html#a4">next</a>( );
00444         <font class="keywordflow">return</font> old;
00445     } <font class="comment">// @stc need to check whether the semantics of this one are consistent</font>
00446     <font class="comment">// ie. does cloning preserve iterator semantics?</font>
<a name="l00447"></a><a class="code" href="class_AssociationsIterator.html#a9">00447</a>     <a class="code" href="class_AssociationsIterator.html#a9">operator void* </a>( )<font class="keyword"> </font>{ <font class="keywordflow">return</font> (<font class="keywordtype">void</font>*)!<a class="code" href="class_AssociationsIterator.html#a5">done</a>(); }
00448 <font class="comment"></font>
00449 <font class="comment">  /////////////////////////////////////////////////////////////////////////</font>
00450 <font class="comment"></font>  <font class="comment">//                                                                     //</font>
00451   <font class="comment">// IPC tools:                                                          //</font>
00452   <font class="comment">//                                                                     //</font><font class="comment"></font>
00453 <font class="comment">  /////////////////////////////////////////////////////////////////////////</font>
00454 <font class="comment"></font>
<a name="l00455"></a><a class="code" href="class_AssociationsIterator.html#l0">00455</a>   <font class="keyword">friend</font> ostream&amp; <a class="code" href="Polynomial_h.html#a2">operator &lt; </a>( ostream&amp; ostr, <font class="keyword">const</font> <a class="code" href="class_AssociationsIterator.html">AssociationsIterator</a>&amp; AI )<font class="keyword"></font>
00456 <font class="keyword">  </font>{
00457     AI.<a class="code" href="class_ObjectOf.html#b0">look</a>()-&gt;write(ostr);
00458     <font class="keywordflow">return</font> ostr;
00459   }
00460   
<a name="l00461"></a><a class="code" href="class_AssociationsIterator.html#l1">00461</a>   <font class="keyword">friend</font> istream&amp; <a class="code" href="Polynomial_h.html#a3">operator &gt; </a>( istream&amp; istr, <a class="code" href="class_AssociationsIterator.html">AssociationsIterator</a>&amp; AI)<font class="keyword"></font>
00462 <font class="keyword">  </font>{
00463     AI.<a class="code" href="class_ObjectOf.html#b2">change</a>()-&gt;read(istr);
00464     <font class="keywordflow">return</font> istr;
00465   }
00466 
00467 <font class="keyword">private</font>:
00468 
<a name="l00469"></a><a class="code" href="class_AssociationsIterator.html#u0">00469</a>   <font class="keyword">typedef</font> <a class="code" href="class_AssociationsIteratorRep.html">AssociationsIteratorRep&lt;Key,Val&gt;</a> <a class="code" href="class_AssociationsIteratorRep.html">AIR</a>;
00470 };
00471 
00472 
00473 <font class="comment">//-------------------------- Associations -----------------------------//</font>
00474 <font class="comment">//----------------------- associated functions ------------------------//</font>
00475  
00476 template &lt;class Key, class Val&gt; <font class="keyword">inline</font> ostream&amp; <font class="keyword">operator</font> &lt;&lt;
<a name="l00477"></a><a class="code" href="Associations_h.html#a0">00477</a>         ( ostream&amp; o, <font class="keyword">const</font> <a class="code" href="class_AssociationsOf.html">AssociationsOf&lt;Key,Val&gt;</a>&amp; a ) {
00478  
00479     <a class="code" href="class_AssociationsIterator.html">AssociationsIterator&lt;Key,Val&gt;</a> iter(a);
00480     o &lt;&lt; <font class="stringliteral">"-"</font>;
00481     <font class="keywordflow">while</font> (iter) {
00482         o &lt;&lt; <font class="stringliteral">"["</font> &lt;&lt; iter.<a class="code" href="class_AssociationsIterator.html#a2">key</a>() &lt;&lt; <font class="stringliteral">":"</font> &lt;&lt; iter.<a class="code" href="class_AssociationsIterator.html#a3">value</a>() &lt;&lt; <font class="stringliteral">"]"</font> &lt;&lt; <font class="stringliteral">"-"</font>;
00483         ++iter;
00484     }
00485     <font class="keywordflow">return</font> o;
00486 }
00487 <font class="comment">// @stc inlined here (instead of defintion in .C) to circumvent g++</font>
00488 <font class="comment">// template problems</font>
00489  
00490 
00491 <font class="comment">//---------------------- methods which iterate -----------------------------</font>
00492 
00493 template &lt;class Key, class Val&gt;
<a name="l00494"></a><a class="code" href="class_AssociationsOf.html#a7">00494</a> <font class="keyword">inline</font> <a class="code" href="class_ListOf.html">ListOf&lt;Key&gt;</a> <a class="code" href="class_AssociationsOf.html#a7">AssociationsOf&lt;Key,Val&gt;::keys</a>( )<font class="keyword"> const</font>
00495 <font class="keyword"></font>
00496 <font class="keyword"></font>{
00497   <a class="code" href="class_ListOf.html">ListOf&lt;Key&gt;</a> result;
00498   <a class="code" href="class_AssociationsIterator.html">AssociationsIterator&lt;Key,Val&gt;</a> I(*<font class="keyword">this</font>);
00499   <font class="keywordflow">while</font> ( !I.<a class="code" href="class_AssociationsIterator.html#a5">done</a>() ) {
00500          result.<a class="code" href="class_ListOf.html#a15">append</a>( I.<a class="code" href="class_AssociationsIterator.html#a2">key</a>() );
00501          I.<a class="code" href="class_AssociationsIterator.html#a4">next</a>();
00502   }
00503   <font class="keywordflow">return</font> result;
00504 }
00505 
00506 <font class="preprocessor">#endif</font>
</font></pre></div><hr><address><small>Generated at Tue Jun 19 09:49:35 2001 for Magnus Classes by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.6 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2001</small></address>
</body>
</html>
