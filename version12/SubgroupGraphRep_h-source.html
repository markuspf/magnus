<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>/magnus/back_end/Subgroup/include/SubgroupGraphRep.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.6 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>/magnus/back_end/Subgroup/include/SubgroupGraphRep.h</h1><a href="SubgroupGraphRep_h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="comment">/*</font>
00002 <font class="comment"> *   $Id: SubgroupGraphRep.h,v 1.8 2000/02/10 00:12:31 bormotov Exp $</font>
00003 <font class="comment"> */</font>
00004 
00005 <font class="comment">// Copyright (C) 1994 The New York Group Theory Cooperative</font>
00006 <font class="comment">// See magnus/doc/COPYRIGHT for the full notice.</font>
00007 
00008 <font class="comment">// Contents: Definition of the SubgroupGraphRep class.</font>
00009 <font class="comment">//</font>
00010 <font class="comment">// Principal Author: Roger Needham</font>
00011 <font class="comment">//</font>
00012 <font class="comment">// Status: in progress</font>
00013 <font class="comment">//</font>
00014 <font class="comment">// Revision History:</font>
00015 <font class="comment">//</font>
00016 <font class="comment">// * 05/97 Dmitry B. implemented IPC tools.</font>
00017 <font class="comment">//</font>
00018 <font class="comment">// Special Notes:</font>
00019 <font class="comment">//</font>
00020 <font class="comment">// * The edge table is just a flat array, rather than a vector of</font>
00021 <font class="comment">//   vectors, to save memory overhead: since the ambient free group is</font>
00022 <font class="comment">//   liable to have small rank, we don't want scads of small vectors on the</font>
00023 <font class="comment">//   heap. The tradeoffs are that random-access lookup of target vertices</font>
00024 <font class="comment">//   requires an integer multiplication, and expanding the table requires</font>
00025 <font class="comment">//   copying the whole thing.</font>
00026 <font class="comment">//   At least the multiplication could be optimized away by changing</font>
00027 <font class="comment">//   consecutive vertex numbers to row offsets into the edge table.</font>
00028 <font class="comment">//   The all-important ordering of vertices would be preserved.</font>
00029 <font class="comment">//</font>
00030 <font class="comment">// * For the sake of efficiency all functions of SubgroupGraphRep work</font>
00031 <font class="comment">//   only with freely reduced words.</font>
00032 <font class="comment">//</font>
00033 <font class="comment">// Next implementation steps:</font>
00034 <font class="comment">//</font>
00035 <font class="comment">// * More arg checking on SAFETY?</font>
00036 <font class="comment">// * Should generating set be given as a VectorOf?</font>
00037 <font class="comment">// * addSubgroupGenerator method.</font>
00038 
00039 
00040 <font class="preprocessor">#ifndef _SUBGROUPGRAPHREP_H_</font>
00041 <font class="preprocessor"></font><font class="preprocessor">#define _SUBGROUPGRAPHREP_H_</font>
00042 <font class="preprocessor"></font>
00043 
00044 <font class="preprocessor">#include "<a class="code" href="Set_h.html">Set.h</a>"</font>
00045 <font class="preprocessor">#include "<a class="code" href="Word_h.html">Word.h</a>"</font>
00046 <font class="preprocessor">#include "<a class="code" href="Vector_h.html">Vector.h</a>"</font>
00047 <font class="preprocessor">#include "<a class="code" href="Generator_h.html">Generator.h</a>"</font>
00048 <font class="preprocessor">#include "<a class="code" href="RefCounter_h.html">RefCounter.h</a>"</font>
00049 
00050 <font class="comment">// #define DEBUG_SubgroupGraph</font>
00051 <font class="comment">// #define DEBUG_IDENTIFY</font>
00052 
00053 <font class="comment">//@db: class SubgroupGraphRep : public RefCounter {</font>
00054 <font class="comment">// RefCounter does not have clone(), therefore clone() is never</font>
00055 <font class="comment">// defined as a virtual method which leads to crash in </font>
00056 <font class="comment">// any deriviation of SubgroupGraph.</font>
00057 
<a name="l00058"></a><a class="code" href="class_SubgroupGraphRep.html">00058</a> <font class="keyword">class </font><a class="code" href="class_SubgroupGraphRep.html">SubgroupGraphRep</a> : <font class="keyword">public</font> <a class="code" href="struct_PureRep.html">PureRep</a> {
00059 
<a name="l00060"></a><a class="code" href="class_SubgroupGraphRep.html#l0">00060</a>   <font class="keyword">friend</font> <font class="keyword">class </font>SubgroupGraphRepReader;
00061 
00062 <font class="keyword">public</font>:
00063   
00064   <a class="code" href="class_SubgroupGraphRep.html#a0">SubgroupGraphRep</a>(<font class="keywordtype">int</font> ambientRank, <font class="keyword">const</font> <a class="code" href="class_SetOf.html">SetOf&lt;Word&gt;</a>&amp; S);
00065   <font class="comment">// Construct a subgroup graph from the rank of the ambient free group,</font>
00066   <font class="comment">// and the subgroup generators.</font>
00067 
00068   <a class="code" href="class_SubgroupGraphRep.html#a0">SubgroupGraphRep</a>(<font class="keywordtype">int</font> ambientRank, <font class="keyword">const</font> <a class="code" href="class_VectorOf.html">VectorOf&lt;Word&gt;</a>&amp; V);
00069   <font class="comment">// Construct a subgroup graph from the rank of the ambient free group,</font>
00070   <font class="comment">// and the subgroup generators.</font>
00071 
00072   <a class="code" href="class_SubgroupGraphRep.html#a0">SubgroupGraphRep</a>(<font class="keyword">const</font> <a class="code" href="class_SubgroupGraphRep.html">SubgroupGraphRep</a>&amp;);
00073   <font class="comment">// Copy constructor does deep copy.</font>
00074   
00075   <a class="code" href="class_SubgroupGraphRep.html#a3">~SubgroupGraphRep</a>( );
00076 
<a name="l00077"></a><a class="code" href="class_SubgroupGraphRep.html#a4">00077</a>   <a class="code" href="class_SubgroupGraphRep.html">SubgroupGraphRep</a>* <a class="code" href="struct_PureRep.html#a1">clone</a>( )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> <font class="keyword">new</font> <a class="code" href="class_SubgroupGraphRep.html#a0">SubgroupGraphRep</a>( *<font class="keyword">this</font> ); }
00078   <font class="comment">// Standard clone.</font>
00079 
<a name="l00080"></a><a class="code" href="class_SubgroupGraphRep.html#a5">00080</a>   <font class="keywordtype">int</font> <a class="code" href="class_SubgroupGraphRep.html#a5">rank</a>( )<font class="keyword"> const </font>{
00081          <font class="keywordflow">return</font> <a class="code" href="class_SubgroupGraphRep.html#b5">numberOfEdges</a>() - numberOfVertices + 1;
00082   }
00083   <font class="comment">// Returns the rank of this subgroup as a free group.</font>
00084 
00085   <a class="code" href="class_VectorOf.html">VectorOf&lt;Word&gt;</a> <a class="code" href="class_SubgroupGraphRep.html#a6">normalizer</a>( );
00086   <font class="comment">// Returns the normalizer of this subgroup.</font>
00087 
00088   <a class="code" href="class_VectorOf.html">VectorOf&lt;Word&gt;</a> <a class="code" href="class_SubgroupGraphRep.html#a7">nielsenBasis</a>( );
00089   <font class="comment">// Returns a Nielsen basis for this subgroup as a free group.</font>
00090 
00091   <a class="code" href="class_Word.html">Word</a> <a class="code" href="class_SubgroupGraphRep.html#a8">nielsenWord</a>(<font class="keywordtype">int</font> i);
00092   <font class="comment">// Returns an i^th element of the Nielsen basis.</font>
00093 
00094   <a class="code" href="class_Word.html">Word</a> <a class="code" href="class_SubgroupGraphRep.html#a9">inNielsenWords</a>(<font class="keyword">const</font> <a class="code" href="class_Word.html">Word</a>&amp; w);
00095   <font class="comment">// Returns the word `w' written in elements of the Nielsen basis.</font>
00096 
00097   <a class="code" href="class_SubgroupGraphRep.html">SubgroupGraphRep</a>* <a class="code" href="class_SubgroupGraphRep.html#a10">join</a>(<font class="keyword">const</font> <a class="code" href="class_SubgroupGraphRep.html">SubgroupGraphRep</a>&amp;) <font class="keyword">const</font>;
00098   <font class="comment">// Returns a SubgroupGraphRep* which represents the join of this</font>
00099   <font class="comment">// subgroup and the argument.</font>
00100 
00101   <a class="code" href="class_SubgroupGraphRep.html">SubgroupGraphRep</a>* <a class="code" href="class_SubgroupGraphRep.html#a11">intersection</a>(<font class="keyword">const</font> <a class="code" href="class_SubgroupGraphRep.html">SubgroupGraphRep</a>&amp; SGR) <font class="keyword">const</font>;
00102   <font class="comment">// Returns a SubgroupGraphRep* which represents the intersection</font>
00103   <font class="comment">// of this subgroup and the argument.</font>
00104 
<a name="l00105"></a><a class="code" href="class_SubgroupGraphRep.html#a12">00105</a>   Bool <a class="code" href="class_SubgroupGraphRep.html#a12">contains</a>(<font class="keyword">const</font> <a class="code" href="class_Word.html">Word</a>&amp; w)<font class="keyword"> const </font>{ <font class="keywordflow">return</font> <a class="code" href="class_SubgroupGraphRep.html#b13">loopSearch</a>(w,0); }
00106   <font class="comment">// Returns TRUE iff this subgroup contains `w'.</font>
00107 
00108   Bool <a class="code" href="class_SubgroupGraphRep.html#a12">contains</a>(<font class="keyword">const</font> <a class="code" href="class_SetOf.html">SetOf&lt;Word&gt;</a>&amp; S) <font class="keyword">const</font>;
00109   <font class="comment">// Returns TRUE iff this subgroup contains the subgroup generated by `S'.</font>
00110 
00111   Bool <a class="code" href="class_SubgroupGraphRep.html#a12">contains</a>(<font class="keyword">const</font> <a class="code" href="class_VectorOf.html">VectorOf&lt;Word&gt;</a>&amp; V) <font class="keyword">const</font>;
00112   <font class="comment">// Returns TRUE iff this subgroup contains the subgroup generated by `V'.</font>
00113 
00114   Bool <a class="code" href="class_SubgroupGraphRep.html#a12">contains</a>(<a class="code" href="class_SubgroupGraphRep.html">SubgroupGraphRep</a>&amp; SGR) <font class="keyword">const</font>;
00115   <font class="comment">// Returns TRUE iff this subgroup contains the argument.</font>
00116 
00117   Bool <a class="code" href="class_SubgroupGraphRep.html#a16">equalTo</a>(<font class="keyword">const</font> <a class="code" href="class_SetOf.html">SetOf&lt;Word&gt;</a>&amp; S);
00118   <font class="comment">// Returns TRUE iff this subgroup and the subgroup generated by `S' are equal.</font>
00119 
00120   Bool <a class="code" href="class_SubgroupGraphRep.html#a16">equalTo</a>(<a class="code" href="class_SubgroupGraphRep.html">SubgroupGraphRep</a>&amp; SGR);
00121   <font class="comment">// Returns TRUE iff this subgroup and the argument are equal.</font>
00122 
00123   Bool <a class="code" href="class_SubgroupGraphRep.html#a18">conjugateInSubgroup</a>(<font class="keyword">const</font> <a class="code" href="class_Word.html">Word</a>&amp; w, <a class="code" href="class_Word.html">Word</a>&amp; conjugator) <font class="keyword">const</font>;
00124   <font class="comment">// Returns TRUE iff some conjugate of `w' is in the subgroup.</font>
00125   <font class="comment">// If TRUE, `conjugator' is set to the conjugator.</font>
00126 
00127   Bool <a class="code" href="class_SubgroupGraphRep.html#a18">conjugateInSubgroup</a>(<font class="keyword">const</font> <a class="code" href="class_SetOf.html">SetOf&lt;Word&gt;</a>&amp; S, <a class="code" href="class_Word.html">Word</a>&amp; conjugator);
00128   <font class="comment">// Returns TRUE iff some conjugate of the subgroup generated by `S' is</font>
00129   <font class="comment">// in the subgroup. If TRUE, `conjugator' is set to the conjugator.</font>
00130 
00131   <font class="keywordtype">bool</font> <a class="code" href="class_SubgroupGraphRep.html#a20">conjugateTo</a>(<font class="keyword">const</font> <a class="code" href="class_SetOf.html">SetOf&lt;Word&gt;</a>&amp; S);
00132   <font class="comment">// Returns true iff this subgroup and the argument are conjugate.</font>
00133 
00134   <font class="keywordtype">long</font> <a class="code" href="class_SubgroupGraphRep.html#a21">powerInSubgroup</a>( <font class="keyword">const</font> <a class="code" href="class_Word.html">Word</a>&amp; aWord ) <font class="keyword">const</font>;
00135   <font class="comment">// returns 'the minimal power' or 0 if there are no powers of the</font>
00136   <font class="comment">// element `aWord' in H.</font>
00137 
00138   <font class="keywordtype">int</font> <a class="code" href="class_SubgroupGraphRep.html#a22">findIndex</a>();
00139   <font class="comment">// returns the index of the subgroup or 0 if infinite.</font>
00140 
00141   <a class="code" href="class_VectorOf.html">VectorOf&lt;Word&gt;</a> <a class="code" href="class_SubgroupGraphRep.html#a23">findWhiteheadBasis</a>();
00142   <font class="comment">// Finds the subgroup of the free group authomorphic to this with</font>
00143   <font class="comment">// smallest sum of lengths of generators.</font>
00144   <font class="comment">// Returns a vector of generators.</font>
00145 
00146   Bool <a class="code" href="class_SubgroupGraphRep.html#a24">isAFreeFactor</a>();
00147   <font class="comment">// Returns TRUE iff this subgroup is a free factor.</font>
00148 
<a name="l00149"></a><a class="code" href="class_SubgroupGraphRep.html#a25">00149</a>   Bool <a class="code" href="class_SubgroupGraphRep.html#a25">generatesTheFreeGroup</a>()<font class="keyword"> const</font>
00150 <font class="keyword">  </font>{ 
00151     <font class="keywordflow">return</font> (numberOfVertices==1)&amp;&amp;(<a class="code" href="class_SubgroupGraphRep.html#a5">rank</a>()==valence/2);
00152   }
00153 
00154   <a class="code" href="class_Word.html">Word</a> <a class="code" href="class_SubgroupGraphRep.html#a26">rightSchreierRepresentative</a>(<font class="keyword">const</font> <a class="code" href="class_Word.html">Word</a>&amp;);
00155 
00156   <font class="keywordtype">void</font> <a class="code" href="class_SubgroupGraphRep.html#a27">MHallComplete</a>();
00157   <font class="comment">// Alters this graph in place so that it becomes a subgroup of</font>
00158   <font class="comment">// the ambient free group of finite index, with the original</font>
00159   <font class="comment">// subgroup a free factor.</font>
00160 
00161   <font class="keywordtype">void</font> <a class="code" href="class_SubgroupGraphRep.html#a28">joinConjugate</a>(<font class="keywordtype">int</font> generator);
00162   <font class="comment">// Alters this graph in place so that it also contains the conjugate</font>
00163   <font class="comment">// by `generator' of every element it contained before.</font>
00164 
<a name="l00165"></a><a class="code" href="class_SubgroupGraphRep.html#a29">00165</a>   <font class="keywordtype">float</font> <a class="code" href="class_SubgroupGraphRep.html#a29">completeness</a>( )<font class="keyword"> const </font>{
00166          <font class="keywordflow">return</font> ( 2 * <a class="code" href="class_SubgroupGraphRep.html#b5">numberOfEdges</a>() ) / ( numberOfVertices * valence );
00167   }
00168 
<a name="l00169"></a><a class="code" href="class_SubgroupGraphRep.html#a30">00169</a>   Bool <a class="code" href="class_SubgroupGraphRep.html#a30">isComplete</a>( )<font class="keyword"> const </font>{
00170          <font class="keywordflow">return</font> ( 2 * <a class="code" href="class_SubgroupGraphRep.html#b5">numberOfEdges</a>() ) == ( numberOfVertices * valence );
00171   }
00172 
<a name="l00173"></a><a class="code" href="class_SubgroupGraphRep.html#a31">00173</a>   <font class="keywordtype">long</font> <a class="code" href="class_SubgroupGraphRep.html#a31">vertexCount</a>( )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> numberOfVertices; }
00174 
00175 <font class="preprocessor">  #ifdef DEBUG</font>
00176 <font class="preprocessor"></font>    <font class="keywordtype">void</font> <a class="code" href="Margin_h.html#a9">debugPrint</a>(ostream&amp;) <font class="keyword">const</font>;
00177     Bool consistentData( ) <font class="keyword">const</font>;
00178     <font class="comment">//friend int main( );</font>
00179 <font class="preprocessor">  #endif</font>
00180 <font class="preprocessor"></font>
<a name="l00181"></a><a class="code" href="class_SubgroupGraphRep.html#s0">00181</a>   <font class="keyword">typedef</font> <font class="keywordtype">long</font> <a class="code" href="class_SubgroupGraphRep.html">VertexType</a>;
00182   <font class="comment">// A signed integer type big enough to hold the number of vertices in a</font>
00183   <font class="comment">// graph. Used for both vertices and indices into vectors of vertices.</font>
00184 
<a name="l00185"></a><a class="code" href="class_SubgroupGraphRep.html#p0">00185</a>   <font class="keyword">static</font> <font class="keyword">const</font> <a class="code" href="class_SubgroupGraphRep.html">VertexType</a> baseVertex = 0;
00186   <font class="comment">// The distinguished vertex, i.e. the only start and accept state for</font>
00187   <font class="comment">// the graph as a word acceptor.</font>
00188 
<a name="l00189"></a><a class="code" href="class_SubgroupGraphRep.html#p1">00189</a>   <font class="keyword">static</font> <font class="keyword">const</font> <a class="code" href="class_SubgroupGraphRep.html">VertexType</a> emptyTarget = -1;
00190 
<a name="l00191"></a><a class="code" href="class_SubgroupGraphRep.html#s1">00191</a>   <font class="keyword">typedef</font> <font class="keywordtype">int</font> <a class="code" href="class_SubgroupGraphRep.html">LabelType</a>;
00192   <font class="comment">// Any integer type big enough to hold twice the ambient rank.</font>
00193 
00194 
<a name="l00195"></a><a class="code" href="class_SubgroupGraphRep.html#a32">00195</a>   <a class="code" href="class_SubgroupGraphRep.html">LabelType</a> <a class="code" href="class_SubgroupGraphRep.html#a32">generatorToLabel</a>(<font class="keywordtype">int</font> g)<font class="keyword"> const </font>{
00196          <font class="keywordflow">return</font> ( g &gt; 0 ? (g - 1) &lt;&lt; 1 : (-g &lt;&lt; 1) - 1 );
00197   }
00198   <font class="comment">// Performs the mapping of Generator ordinals to labels:</font>
00199   <font class="comment">// . . . -3 -2 -1  1  2  3 . . .</font>
00200   <font class="comment">// . . .  5  3  1  0  2  4. . .</font>
00201   <font class="comment">// This is the inverse function of `labelToGenerator'.</font>
00202 
00203 
<a name="l00204"></a><a class="code" href="class_SubgroupGraphRep.html#a33">00204</a>   <font class="keywordtype">int</font> <a class="code" href="class_SubgroupGraphRep.html#a33">labelToGenerator</a>(<a class="code" href="class_SubgroupGraphRep.html">LabelType</a> label)<font class="keyword"> const </font>{
00205          <font class="keywordflow">return</font> ( label &amp; 1 ? ( -1 - label ) &gt;&gt; 1 : ( label + 2 ) &gt;&gt; 1 );
00206   }
00207   <font class="comment">// Performs the mapping of labels to Generator ordinals:</font>
00208   <font class="comment">// 0  1  2  3  4  5 . . .</font>
00209   <font class="comment">// 1 -1  2 -2  3 -3</font>
00210   <font class="comment">// This is the inverse function of `generatorToLabel'.</font>
00211 
00212 
<a name="l00213"></a><a class="code" href="class_SubgroupGraphRep.html#a34">00213</a>   <a class="code" href="class_SubgroupGraphRep.html">LabelType</a> <a class="code" href="class_SubgroupGraphRep.html#a34">inverseLabel</a>(<a class="code" href="class_SubgroupGraphRep.html">LabelType</a> label)<font class="keyword"> const </font>{
00214          <font class="keywordflow">return</font> ( label &amp; 1 ? label - 1 : label + 1 );
00215   }
00216   <font class="comment">// Returns the label representing the inverse generator to the</font>
00217   <font class="comment">// generator represented by `label'.</font>
00218 
00219 
<a name="l00220"></a><a class="code" href="class_SubgroupGraphRep.html#a35">00220</a>   <a class="code" href="class_SubgroupGraphRep.html">VertexType</a> <a class="code" href="class_SubgroupGraphRep.html#a35">targetOfGenerator</a>(<a class="code" href="class_SubgroupGraphRep.html">VertexType</a> source, <font class="keywordtype">int</font> generator)<font class="keyword"> const </font>{
00221          <font class="keywordflow">return</font> table[ source * valence + <a class="code" href="class_SubgroupGraphRep.html#a32">generatorToLabel</a>(generator) ];
00222   }
00223   <font class="comment">// Returns the vertex gotten to from `source' vertex via `generator'.</font>
00224   <font class="comment">// -1 means there is no such edge.</font>
00225 
00226 
<a name="l00227"></a><a class="code" href="class_SubgroupGraphRep.html#a36">00227</a>   <a class="code" href="class_SubgroupGraphRep.html">VertexType</a> <a class="code" href="class_SubgroupGraphRep.html#a36">targetOfLabel</a>(<a class="code" href="class_SubgroupGraphRep.html">VertexType</a> source, <a class="code" href="class_SubgroupGraphRep.html">LabelType</a> label)<font class="keyword"> const </font>{
00228          <font class="keywordflow">return</font> table[ source * valence + label ];
00229   }
00230   <font class="comment">// Returns the vertex gotten to from `source' vertex via `label'.</font>
00231   <font class="comment">// -1 means there is no such edge.</font>
00232 
00233 
<a name="l00234"></a><a class="code" href="class_SubgroupGraphRep.html#a37">00234</a>   <a class="code" href="class_SubgroupGraphRep.html">LabelType</a> <a class="code" href="class_SubgroupGraphRep.html#a37">getValence</a>( )<font class="keyword"> const </font>{
00235     <font class="keywordflow">return</font> valence;
00236   } 
00237 <font class="comment"></font>
00238 <font class="comment">  /////////////////////////////////////////////////////////////////////////</font>
00239 <font class="comment"></font>  <font class="comment">//                                                                     //</font>
00240   <font class="comment">// IPC tools:                                                          //</font>
00241   <font class="comment">//                                                                     //</font><font class="comment"></font>
00242 <font class="comment">  /////////////////////////////////////////////////////////////////////////</font>
00243 <font class="comment"></font>
00244   <font class="keyword">virtual</font> <font class="keywordtype">void</font> <a class="code" href="class_SubgroupGraphRep.html#a38">write</a>( ostream&amp; ostr ) <font class="keyword">const</font>;
00245  
00246   <font class="keyword">virtual</font> <font class="keywordtype">void</font> <a class="code" href="class_SubgroupGraphRep.html#a39">read</a>( istream&amp; istr );
00247 
00248   <font class="keyword">virtual</font> <font class="keywordtype">bool</font> <a class="code" href="class_SubgroupGraphRep.html#a40">readPiece</a>( istream&amp; istr, <font class="keyword">const</font> <font class="keyword">class</font> <a class="code" href="class_Timer.html">Timer</a>&amp; timer );
00249   <font class="comment">// To read a big amount of information piece by piece. Returns true</font>
00250   <font class="comment">// if the last is read, false otherwise.</font>
00251  
00252 
00253 <font class="comment">//@dbprivate:</font>
00254 <font class="keyword">protected</font>:
00255 
00256   <font class="comment">// IPC private data:</font>
00257 
00258   <font class="keyword">enum</font> { STOP, TABLE, SUBTREE, BASIS_EDGES };
<a name="l00259"></a><a class="code" href="class_SubgroupGraphRep.html#n0">00259</a>   <font class="keywordtype">int</font> isReading;
<a name="l00260"></a><a class="code" href="class_SubgroupGraphRep.html#n1">00260</a>   <font class="keywordtype">int</font> tableSize, n;
00261 
00262 <font class="comment"></font>
00263 <font class="comment">  /////////////////////////////////////////////////////////////////////////</font>
00264 <font class="comment"></font>  <font class="comment">//                                                                     //</font>
00265   <font class="comment">// Private members of the class:                                       //</font>
00266   <font class="comment">//                                                                     //</font><font class="comment"></font>
00267 <font class="comment">  /////////////////////////////////////////////////////////////////////////</font>
00268 <font class="comment"></font>
00269   <font class="comment">// A graph is comprised of vertices, (edge) labels, and</font>
00270   <font class="comment">// a set of ordered triples (source vertex, label, target vertex).</font>
00271   <font class="comment">//</font>
00272   <font class="comment">// Our labels are integers 0, 1, ..., valence - 1, which represent</font>
00273   <font class="comment">// group generators; we map Generator ordinals to labels in the</font>
00274   <font class="comment">// sequence 1, -1, 2, -2, ...</font>
00275   <font class="comment">//</font>
00276   <font class="comment">// Our vertices are integers numbered 0, 1, ..., numberOfVertices - 1.</font>
00277 
00278 
<a name="l00279"></a><a class="code" href="struct_SubgroupGraphRep__Edge.html">00279</a>   <font class="keyword">struct </font>Edge {
<a name="l00280"></a><a class="code" href="struct_SubgroupGraphRep__Edge.html#m0">00280</a>     <a class="code" href="class_SubgroupGraphRep.html">VertexType</a> v;          <font class="comment">// initial vertex</font>
<a name="l00281"></a><a class="code" href="struct_SubgroupGraphRep__Edge.html#m1">00281</a>     <a class="code" href="class_SubgroupGraphRep.html">LabelType</a>  l;
00282 
<a name="l00283"></a><a class="code" href="struct_SubgroupGraphRep__Edge.html#a0">00283</a>     Edge&amp; <a class="code" href="struct_SubgroupGraphRep__Edge.html#a0">operator = </a>( <font class="keyword">const</font> Edge&amp; anEdge )<font class="keyword"> </font>{ 
00284          v = anEdge.v; l = anEdge.l; 
00285          <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00286     }
<a name="l00287"></a><a class="code" href="struct_SubgroupGraphRep__Edge.html#a1">00287</a>     Bool <a class="code" href="struct_SubgroupGraphRep__Edge.html#a1">operator &lt; </a>( <font class="keyword">const</font> Edge&amp; anEdge )<font class="keyword"> const </font>{
00288          <font class="keywordflow">if</font> ( v &lt; anEdge.v ) <font class="keywordflow">return</font> TRUE;
00289          <font class="keywordflow">if</font> ( v &gt; anEdge.v ) <font class="keywordflow">return</font> FALSE;
00290          <font class="keywordflow">if</font> ( l &lt; anEdge.l ) <font class="keywordflow">return</font> TRUE;
00291          <font class="keywordflow">return</font> FALSE;
00292     }
<a name="l00293"></a><a class="code" href="struct_SubgroupGraphRep__Edge.html#a2">00293</a>     Bool <a class="code" href="struct_SubgroupGraphRep__Edge.html#a2">operator &gt; </a>( <font class="keyword">const</font> Edge&amp; anEdge )<font class="keyword"> const </font>{
00294          <font class="keywordflow">if</font> ( v &gt; anEdge.v ) <font class="keywordflow">return</font> TRUE;
00295          <font class="keywordflow">if</font> ( v &lt; anEdge.v ) <font class="keywordflow">return</font> FALSE;
00296          <font class="keywordflow">if</font> ( l &gt; anEdge.l ) <font class="keywordflow">return</font> TRUE;
00297          <font class="keywordflow">return</font> FALSE;
00298     }
00299     
<a name="l00300"></a><a class="code" href="struct_SubgroupGraphRep__Edge.html#l0">00300</a>     <font class="keyword">friend</font> ostream&amp; <a class="code" href="struct_SubgroupGraphRep__Edge.html#a1">operator &lt; </a>( ostream&amp; ostr, <font class="keyword">const</font> Edge&amp; e )<font class="keyword"></font>
00301 <font class="keyword">    </font>{
00302       ostr &lt; e.v &lt; e.l;
00303       <font class="keywordflow">return</font> ostr;
00304     }
00305     
<a name="l00306"></a><a class="code" href="struct_SubgroupGraphRep__Edge.html#l1">00306</a>     <font class="keyword">friend</font> istream&amp; <a class="code" href="struct_SubgroupGraphRep__Edge.html#a2">operator &gt; </a>( istream&amp; istr, Edge&amp; e )<font class="keyword"></font>
00307 <font class="keyword">    </font>{
00308       istr &gt; e.v &gt; e.l;
00309       <font class="keywordflow">return</font> istr;
00310     }
00311 
00312   };
00313   
00314   <font class="comment">// Data members:</font>
00315 
<a name="l00316"></a><a class="code" href="class_SubgroupGraphRep.html#n3">00316</a>   <a class="code" href="class_SubgroupGraphRep.html">VertexType</a>* table;
00317   <font class="comment">// Holds a transition table, represented by a 2D array of</font>
00318   <font class="comment">// numberOfVertices rows and valence columns.</font>
00319   <font class="comment">// The entry in row i and column j is the target vertex of</font>
00320   <font class="comment">// source vertex i via label j.</font>
00321   <font class="comment">// This means that finding the target of a label from a source vertex</font>
00322   <font class="comment">// requires a multiplication.</font>
00323 
<a name="l00324"></a><a class="code" href="class_SubgroupGraphRep.html#n4">00324</a>   <a class="code" href="class_SubgroupGraphRep.html">VertexType</a> numberOfVertices;   <font class="comment">// Actual number of vertices allocated in table</font>
<a name="l00325"></a><a class="code" href="class_SubgroupGraphRep.html#n5">00325</a>   <a class="code" href="class_SubgroupGraphRep.html">VertexType</a> spaceForVertices;   <font class="comment">// Number of vertices table can hold</font>
<a name="l00326"></a><a class="code" href="class_SubgroupGraphRep.html#n6">00326</a>   <a class="code" href="class_SubgroupGraphRep.html">LabelType</a>  valence;            <font class="comment">// Number of labels</font>
00327 
00328 
<a name="l00329"></a><a class="code" href="class_SubgroupGraphRep.html#n7">00329</a>   <a class="code" href="class_SubgroupGraphRep.html">LabelType</a>* maximalSubtree;
<a name="l00330"></a><a class="code" href="class_SubgroupGraphRep.html#n8">00330</a>   Edge* basisEdges;
00331   <font class="comment">// These are NULL after the constructor exits. They must be explicitly</font>
00332   <font class="comment">// initialized by a call to makeMaxlSubtree(). Do NOT forget to</font>
00333   <font class="comment">// reinitialize these if table changes.</font>
00334   <font class="comment">// </font>
00335   <font class="comment">// maximalSubtree `contains' backpointers which define a maximal subtree</font>
00336   <font class="comment">// of the graph: if the maximal subtree contains the edge V1 -- L --&gt; V2,</font>
00337   <font class="comment">// then maximalSubtree[V2] == L^-1 (so V1 can be gotten from table).</font>
00338   <font class="comment">// This is used to extract a Nielsen basis, and to find a Nielsen-Schreier</font>
00339   <font class="comment">// representative of a word in the ambient free group.</font>
00340   <font class="comment">// </font>
00341   <font class="comment">// basisEdges `contains' those edges of the graph which are missing from</font>
00342   <font class="comment">// the maximal subtree. basisEdges is sorted ( lexicographical order on </font>
00343   <font class="comment">// pairs (iVertex,label).</font>
00344   <font class="comment">//</font>
00345   <font class="comment">// This is used to extract a Nielsen basis, and to write a word in the</font>
00346   <font class="comment">// subgroup as a word in that Nielsen basis.</font>
00347   <font class="comment">//</font>
00348   <font class="comment">// There is still the problem of indexing basis edges, so that we know</font>
00349   <font class="comment">// which element of the Nielsen basis corresponds to which edge.</font>
00350 
00351   
00352   <font class="comment">// Private methods:</font>
00353 
00354 
00355   <a class="code" href="class_SubgroupGraphRep.html#a0">SubgroupGraphRep</a>(<font class="keywordtype">int</font> whatValence, <font class="keywordtype">long</font> howManyVertices);
00356   <font class="comment">// Construct a SubgroupGraphRep with `table' initialized for</font>
00357   <font class="comment">//   numberOfVertices == 1,</font>
00358   <font class="comment">//   spaceForVertices == howManyVertices,</font>
00359   <font class="comment">//   valence == whatValence.</font>
00360 
00361 
00362   <font class="keywordtype">void</font> <a class="code" href="class_SubgroupGraphRep.html#b1">resize</a>(<font class="keywordtype">long</font> howManyVertices);
00363   <font class="comment">// Data members `table', `valence' and `numberOfVertices' must have</font>
00364   <font class="comment">// correct values before calling this.</font>
00365   <font class="comment">// Resizes `table' to have exactly enough room for `howManyVertices',</font>
00366   <font class="comment">// copying any that are already there, initializes any new vertices</font>
00367   <font class="comment">// to have no edges, and sets values of `numberOfVertices' and</font>
00368   <font class="comment">// `spaceForVertices' if the size changes.</font>
00369 
00370 
<a name="l00371"></a><a class="code" href="class_SubgroupGraphRep.html#b2">00371</a>   <font class="keywordtype">void</font> <a class="code" href="class_SubgroupGraphRep.html#b2">defineEdges</a>(<a class="code" href="class_SubgroupGraphRep.html">VertexType</a> source, <font class="keywordtype">int</font> generator, <a class="code" href="class_SubgroupGraphRep.html">VertexType</a> target)<font class="keyword"> </font>{
00372 <font class="preprocessor">         #if SAFETY &gt; 1</font>
00373 <font class="preprocessor"></font>         <font class="keywordflow">if</font> ( (source &lt; 0) || (source &gt;= numberOfVertices) ||
00374                         (target &lt; -1) || (target &gt;= numberOfVertices) ||
00375                         (<a class="code" href="class_SubgroupGraphRep.html#a32">generatorToLabel</a>(generator) &lt; 0) ||
00376                         (<a class="code" href="class_SubgroupGraphRep.html#a32">generatorToLabel</a>(generator) &gt;= valence) )
00377                 <a class="code" href="error_h.html#a0">error</a>(<font class="stringliteral">"bad arg(s) to SubgroupGraphRep::defineEdges"</font>);
00378 <font class="preprocessor">         #endif</font>
00379 <font class="preprocessor"></font>
00380          table[ source * valence + <a class="code" href="class_SubgroupGraphRep.html#a32">generatorToLabel</a>(generator) ] = target;
00381          table[ target * valence + <a class="code" href="class_SubgroupGraphRep.html#a32">generatorToLabel</a>(-generator) ] = source;
00382   }
00383   <font class="comment">// Makes `generator' take `source' vertex to `target' vertex, and</font>
00384   <font class="comment">// the inverse generator take `target' vertex to `source' vertex.</font>
00385 
00386 
<a name="l00387"></a><a class="code" href="class_SubgroupGraphRep.html#b3">00387</a>   <a class="code" href="class_SubgroupGraphRep.html">VertexType</a> <a class="code" href="class_SubgroupGraphRep.html#b2">defineEdges</a>(<a class="code" href="class_SubgroupGraphRep.html">VertexType</a> source, <font class="keywordtype">int</font> generator)<font class="keyword"> </font>{
00388 <font class="preprocessor">         #if SAFETY &gt; 1</font>
00389 <font class="preprocessor"></font>         <font class="keywordflow">if</font> ( numberOfVertices &gt; spaceForVertices )
00390                 <a class="code" href="error_h.html#a0">error</a>(<font class="stringliteral">"table overflow in SubgroupGraphRep::defineEdges"</font>);
00391 <font class="preprocessor">         #endif</font>
00392 <font class="preprocessor"></font>         <font class="keywordflow">if</font> ( numberOfVertices == spaceForVertices )
00393                 <a class="code" href="class_SubgroupGraphRep.html#b1">resize</a>(numberOfVertices + <a class="code" href="global_h.html#a6">max</a>(numberOfVertices / 5, 100)); <font class="comment">//@rn experiment</font>
00394          ++numberOfVertices;
00395          <a class="code" href="class_SubgroupGraphRep.html#b2">defineEdges</a>(source, generator, numberOfVertices - 1);
00396          <font class="keywordflow">return</font> numberOfVertices - 1;
00397   }
00398   <font class="comment">// This version defines a new (target) vertex before doing the work</font>
00399   <font class="comment">// of `defineEdges', and returns the new vertex.</font>
00400 
00401 
<a name="l00402"></a><a class="code" href="class_SubgroupGraphRep.html#b4">00402</a>   <font class="keywordtype">void</font> <a class="code" href="class_SubgroupGraphRep.html#b4">defineEdge</a>(<a class="code" href="class_SubgroupGraphRep.html">VertexType</a> source, <a class="code" href="class_SubgroupGraphRep.html">LabelType</a> label, <a class="code" href="class_SubgroupGraphRep.html">VertexType</a> target)<font class="keyword"> </font>{
00403          table[ source * valence + label ] = target;
00404   }
00405   <font class="comment">// Makes `label' take `source' vertex to `target' vertex.</font>
00406 
00407 
00408   <font class="keywordtype">long</font> <a class="code" href="class_SubgroupGraphRep.html#b5">numberOfEdges</a>( ) <font class="keyword">const</font>;
00409   <font class="comment">// Returns the number of edge pairs in this graph; an edge labelled by</font>
00410   <font class="comment">// a generator and one by the inverse of that generator count as one.</font>
00411 
00412   <font class="keywordtype">long</font> <a class="code" href="class_SubgroupGraphRep.html#b6">valenceAt</a>(<a class="code" href="class_SubgroupGraphRep.html">VertexType</a> v) <font class="keyword">const</font>;
00413   <font class="comment">// Returns the number of edges outcomming from `v'.</font>
00414                                                 
00415 
00416   <font class="keywordtype">void</font> <a class="code" href="class_SubgroupGraphRep.html#b7">adjoinWord</a>(<font class="keyword">const</font> <a class="code" href="class_Word.html">Word</a>&amp;, <a class="code" href="class_SubgroupGraphRep.html">VertexType</a>);
00417   <font class="comment">// Adjoins the Word to this graph, which is the same as adding</font>
00418   <font class="comment">// the Word to the generating set of this subgroup.</font>
00419   <font class="comment">// Calls defineEdges to make new edges, which resizes `table'</font>
00420   <font class="comment">// if necessary, and may leave extra space.</font>
00421 
00422 
00423   <font class="keywordtype">void</font> <a class="code" href="class_SubgroupGraphRep.html#b8">addWordArc</a>(<font class="keyword">const</font> <a class="code" href="class_Word.html">Word</a>&amp;, <a class="code" href="class_SubgroupGraphRep.html">VertexType</a>, <a class="code" href="class_SubgroupGraphRep.html">VertexType</a>, <font class="keywordtype">int</font>, <font class="keywordtype">int</font>);
00424   <font class="comment">// Specialized version of adjoinWord.</font>
00425 
00426 
00427   <font class="keywordtype">void</font> <a class="code" href="class_SubgroupGraphRep.html#b9">addWordLoop</a>(<font class="keyword">const</font> <a class="code" href="class_Word.html">Word</a>&amp;, <a class="code" href="class_SubgroupGraphRep.html">VertexType</a>, <font class="keywordtype">int</font>, <font class="keywordtype">int</font>);
00428   <font class="comment">// Specialized version of adjoinWord.</font>
00429 
00430 
00431   <font class="keywordtype">void</font> <a class="code" href="class_SubgroupGraphRep.html#b10">identifyVertices</a>(<a class="code" href="class_SubgroupGraphRep.html">VertexType</a>, <a class="code" href="class_SubgroupGraphRep.html">VertexType</a>);
00432   <font class="comment">// Folds this graph as necessary so that the two vertices are the same,</font>
00433   <font class="comment">// then recovers any unneeded space.</font>
00434 
00435 
00436   <font class="keywordtype">void</font> <a class="code" href="class_SubgroupGraphRep.html#b11">reduceGraph</a>(<a class="code" href="class_SubgroupGraphRep.html">VertexType</a>*);
00437   <font class="comment">// See comments in function body. Recovers any unneeded space.</font>
00438 
00439 
00440   <a class="code" href="class_SubgroupGraphRep.html">SubgroupGraphRep</a>* <a class="code" href="class_SubgroupGraphRep.html#b12">disjointUnion</a>(<font class="keyword">const</font> <a class="code" href="class_SubgroupGraphRep.html">SubgroupGraphRep</a>&amp;) <font class="keyword">const</font>;
00441   <font class="comment">// Returns a SubgroupGraphRep* which is the literal graph-wise</font>
00442   <font class="comment">// disjoint union of the argument and this graph.</font>
00443 
00444   Bool <a class="code" href="class_SubgroupGraphRep.html#b13">loopSearch</a>(<font class="keyword">const</font> <a class="code" href="class_Word.html">Word</a>&amp; w, <a class="code" href="class_SubgroupGraphRep.html">VertexType</a> v) <font class="keyword">const</font>;
00445   <font class="comment">// Returns TRUE iff there is a cycle starting at `v' with label `w'.</font>
00446 
00447   <a class="code" href="class_Word.html">Word</a> <a class="code" href="class_SubgroupGraphRep.html#b14">getLabel</a>(<a class="code" href="class_SubgroupGraphRep.html">VertexType</a> v) <font class="keyword">const</font>;
00448   <font class="comment">// Returns the label of the path from the base vertex to `v' along the</font>
00449   <font class="comment">// maximal subtree.</font>
00450 
00451   <a class="code" href="class_Word.html">Word</a> <a class="code" href="class_SubgroupGraphRep.html#b15">getInverseLabel</a>(<a class="code" href="class_SubgroupGraphRep.html">VertexType</a> v) <font class="keyword">const</font>;
00452   <font class="comment">// Returns the label of the path from `v' to the base vertex along the</font>
00453   <font class="comment">// maximal subtree.</font>
00454 
00455   <font class="keywordtype">int</font> <a class="code" href="class_SubgroupGraphRep.html#b16">findBasisEdgeIndex</a>(<a class="code" href="class_SubgroupGraphRep.html">VertexType</a> source,<a class="code" href="class_SubgroupGraphRep.html">LabelType</a> label);
00456   <font class="comment">// Returns index of this edge in BasisEdges if passing it in positive</font>
00457   <font class="comment">// direction or -index if passing in negative. 1-based index.</font>
00458 
00459   <font class="keywordtype">void</font> <a class="code" href="class_SubgroupGraphRep.html#b17">makeMaxlSubtree</a>( );
00460   <font class="comment">// See the comments above for maximalSubtree and basisEdges.</font>
00461 
00462   <font class="keywordtype">int</font> <a class="code" href="class_SubgroupGraphRep.html#b18">distanceFromOrigin</a>(<a class="code" href="class_SubgroupGraphRep.html">VertexType</a>) <font class="keyword">const</font>;
00463 
00464 };
00465 
00466 <font class="preprocessor">#endif</font>
</font></pre></div><hr><address><small>Generated at Tue Jun 19 09:49:43 2001 for Magnus Classes by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.6 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2001</small></address>
</body>
</html>
