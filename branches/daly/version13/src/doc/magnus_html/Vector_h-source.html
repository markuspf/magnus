<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>/magnus/back_end/general/include/Vector.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.6 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>/magnus/back_end/general/include/Vector.h</h1><a href="Vector_h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="comment">/*</font>
00002 <font class="comment"> *   $Id: Vector.h,v 1.14 2000/03/03 04:11:11 bormotov Exp $</font>
00003 <font class="comment"> */</font>
00004  
00005 <font class="comment">//   Copyright (C) 1994 The New York Group Theory Cooperative</font>
00006 <font class="comment">//   See magnus/doc/COPYRIGHT for the full notice.</font>
00007  
00008 <font class="comment">// Contents: Definition of VectorOf&lt;T&gt; and VectorRep&lt;T&gt; class</font>
00009 <font class="comment">//</font>
00010 <font class="comment">// Principal Author: Stephane Collart, Roger Needham</font>
00011 <font class="comment">//</font>
00012 <font class="comment">// Status: Useable.</font>
00013 <font class="comment">//</font>
00014 <font class="comment">// Revision History:</font>
00015 <font class="comment">//</font>
00016 <font class="comment">// * 27.10.94 StC gave VectorItemRef::operator= a reference return type</font>
00017 <font class="comment">// * 11.11.94 Stc gave Vector a ctor to make a vector of specified length</font>
00018 <font class="comment">//                initialised from another vector</font>
00019 <font class="comment">// * 3/95 sr added</font>
00020 <font class="comment">//        int hash() const</font>
00021 <font class="comment">//        so that sets of vectors are (marginally) possible.</font>
00022 <font class="comment">// * 3/95 sr added</font>
00023 <font class="comment">//        VectorOf( int len, bool e )</font>
00024 <font class="comment">//        VectorOf( int len, bool e, const VectorOf&amp; v )</font>
00025 <font class="comment">//</font>
00026 <font class="comment">// * 01/96 Dmitry B. implemented IPC tools.</font>
00027 <font class="comment">//</font>
00028 <font class="comment">// * 7/96 Dmitry B. made porting to gcc 2.7.2.</font>
00029 <font class="comment">//</font>
00030 <font class="comment">// * 2/97 EP added a method:</font>
00031 <font class="comment">//           const T&amp; constref(int i) const;</font>
00032 <font class="comment">//        to enhance the i-th element of the vector.</font>
00033 <font class="comment">//</font>
00034 <font class="comment">//</font>
00035 <font class="comment">// * 02/97 dp fixed VectorRep::shrink(int start, int newlen).</font>
00036 <font class="comment">//</font>
00037 <font class="comment">// * 03/97 dp remove empty body from private member (hidden, not to be implemented)</font>
00038 <font class="comment">//            VectorRep&amp; VectorRep::operator = ( const VectorRep&amp; );</font>
00039 <font class="comment">//</font>
00040 <font class="comment">// Special Notes:</font>
00041 <font class="comment">//</font>
00042 <font class="comment">// * To instantiate VectorOf&lt;T&gt;, class T must have</font>
00043 <font class="comment">//   1) A default constructor</font>
00044 <font class="comment">//   2) A copy constructor</font>
00045 <font class="comment">//   3) An assignment operator</font>
00046 <font class="comment">//   4) An == operator</font>
00047 <font class="comment">//   5) A destructor</font>
00048 <font class="comment">//</font>
00049 <font class="comment">// Further implementation steps:</font>
00050 <font class="comment">//</font>
00051 <font class="comment">// * Analogs of the List methods would be nice.</font>
00052 <font class="comment">//</font>
00053 <font class="comment">// * Should negative indices count from the end of the vector?</font>
00054 <font class="comment">//</font>
00055 <font class="comment">// * VectorOf should also have cast constructors from SetOf, ListOf, etc,</font>
00056 <font class="comment">//   in order to be able to conveniently use the latter where a VectorOf</font>
00057 <font class="comment">//   is expected in a constructor etc.</font>
00058 <font class="comment">//</font>
00059 <font class="comment">// * Should some compatibility mechanism be installed between things</font>
00060 <font class="comment">//   like say VectorOf&lt;Elt&gt; and VectorOf&lt;Word&gt;?</font>
00061 <font class="comment">//</font>
00062 <font class="comment">// Bugs:</font>
00063 <font class="comment">//</font>
00064 <font class="comment">// * g++ 2.5.8 and less can't find templates of non-inlined functions</font>
00065 <font class="comment">//   so it is necessary to give explicit definitions in Vector.C of</font>
00066 <font class="comment">//   every instance.</font>
00067 <font class="comment">//</font>
00068  
00069 <font class="preprocessor">#ifndef _VECTOR_H_</font>
00070 <font class="preprocessor"></font><font class="preprocessor">#define _VECTOR_H_</font>
00071 <font class="preprocessor"></font> 
00072 
00073 <font class="preprocessor">#include "<a class="code" href="global_h.html">global.h</a>"</font>
00074 <font class="preprocessor">#include "<a class="code" href="RefCounter_h.html">RefCounter.h</a>"</font>
00075 <font class="preprocessor">#include "<a class="code" href="ObjectOf_h.html">ObjectOf.h</a>"</font>
00076 <font class="preprocessor">#include "<a class="code" href="Chars_h.html">Chars.h</a>"</font>
00077 <font class="preprocessor">#include "<a class="code" href="ExtendedIPC_h.html">ExtendedIPC.h</a>"</font>
00078 
<a name="l00079"></a><a class="code" href="struct_VectorRep.html">00079</a> template &lt;class T&gt; <font class="keyword">struct </font><a class="code" href="struct_VectorRep.html">VectorRep</a> : <font class="keyword">public</font> <a class="code" href="class_RefCounter.html">RefCounter</a> {
00080   
00081   <font class="keyword">public</font> :
00082   
00083   <font class="comment">// copy constructor does deep copy</font>
00084   
<a name="l00085"></a><a class="code" href="struct_VectorRep.html#a0">00085</a>   <a class="code" href="struct_VectorRep.html#a0">VectorRep</a>( <font class="keyword">const</font> <a class="code" href="struct_VectorRep.html">VectorRep</a>&amp; vr )<font class="keyword"> </font>{
00086          
00087          len = vr.last - vr.first;
00088          first = 0;
00089          last = len;
00090          vec = <font class="keyword">new</font> T[len];
00091 <font class="preprocessor">#if ( SAFETY &gt; 1 )</font>
00092 <font class="preprocessor"></font>         <font class="keywordflow">if</font>( !vec )
00093            <a class="code" href="error_h.html#a0">error</a>(<font class="stringliteral">"Cannot allocate memory in VectorRep::VectorRep( const VectorRep&amp; vr )"</font>);
00094 <font class="preprocessor">#endif</font>
00095 <font class="preprocessor"></font>         <font class="keywordflow">for</font>( <font class="keywordtype">int</font> i = 0; i &lt; len; i++ )
00096                 vec[i] = vr.vec[vr.first + i];
00097          fastExpansion = <font class="keyword">false</font>;
00098   }
00099   
<a name="l00100"></a><a class="code" href="struct_VectorRep.html#a1">00100</a>   <a class="code" href="struct_VectorRep.html#a0">VectorRep</a>( <font class="keywordtype">int</font> l )<font class="keyword"> </font>{
00101          len = l;
00102          first = 0;
00103          last = len;
00104          vec = <font class="keyword">new</font> T[len];
00105 <font class="preprocessor">#if ( SAFETY &gt; 1 )</font>
00106 <font class="preprocessor"></font>         <font class="keywordflow">if</font>( !vec )
00107            <a class="code" href="error_h.html#a0">error</a>(<font class="stringliteral">"Cannot allocate memory in VectorRep::VectorRep(int)"</font>);
00108 <font class="preprocessor">#endif</font>
00109 <font class="preprocessor"></font>         fastExpansion = <font class="keyword">false</font>;
00110   }
00111   <font class="comment">// creates an uninitialized vector of length l</font>
00112   
<a name="l00113"></a><a class="code" href="struct_VectorRep.html#a2">00113</a>   <a class="code" href="struct_VectorRep.html#a0">VectorRep</a>( <font class="keywordtype">int</font> l, <font class="keywordtype">bool</font> e )<font class="keyword"> </font>{
00114          len = l;
00115          first = 0;
00116          last = len;
00117          vec = <font class="keyword">new</font> T[len];
00118 <font class="preprocessor">#if ( SAFETY &gt; 1 )</font>
00119 <font class="preprocessor"></font>         <font class="keywordflow">if</font>( !vec )
00120            <a class="code" href="error_h.html#a0">error</a>(<font class="stringliteral">"Cannot allocate memory in VectorRep::VectorRep(int,bool)"</font>);
00121 <font class="preprocessor">#endif</font>
00122 <font class="preprocessor"></font>         fastExpansion = e;
00123   }
00124   <font class="comment">// creates an uninitialized vector of length l</font>
00125 
<a name="l00126"></a><a class="code" href="struct_VectorRep.html#a3">00126</a>   <a class="code" href="struct_VectorRep.html#a3">~VectorRep</a>( )<font class="keyword"> </font>{ <font class="keyword">delete</font> [] vec; }
00127   
00128   <font class="comment">// standard cloning operation for representations</font>
00129   
<a name="l00130"></a><a class="code" href="struct_VectorRep.html#a4">00130</a>   <a class="code" href="struct_VectorRep.html">VectorRep</a>* <a class="code" href="struct_VectorRep.html#a4">clone</a>( )<font class="keyword"> </font>{ <font class="keywordflow">return</font> <font class="keyword">new</font> <a class="code" href="struct_VectorRep.html#a0">VectorRep</a>( *<font class="keyword">this</font> ); }
00131 
<a name="l00132"></a><a class="code" href="struct_VectorRep.html#a5">00132</a>   <font class="keywordtype">int</font> <a class="code" href="struct_VectorRep.html#a5">length</a>()<font class="keyword"> const </font>{ <font class="keywordflow">return</font> last - first; }
00133 
00134   <font class="comment">// for reference access</font>
<a name="l00135"></a><a class="code" href="struct_VectorRep.html#a6">00135</a>   T&amp; <a class="code" href="struct_VectorRep.html#a6">ref</a>(<font class="keywordtype">int</font> i)<font class="keyword"> </font>{
00136 <font class="preprocessor">    #if ( SAFETY &gt; 0 )</font>
00137 <font class="preprocessor"></font>           <font class="keywordflow">if</font> ( i &lt; 0 || i &gt;= last - first ) <a class="code" href="error_h.html#a0">error</a>(<font class="stringliteral">"VectorOf index out of bounds"</font>
00138                         <font class="stringliteral">" in T&amp; VectorRep::ref(int)"</font>);
00139 <font class="preprocessor">         #endif</font>
00140 <font class="preprocessor"></font>         <font class="keywordflow">return</font> vec[first + i];
00141   }
00142   
00143   <font class="comment">// for constant reference access</font>
<a name="l00144"></a><a class="code" href="struct_VectorRep.html#a7">00144</a>   <font class="keyword">const</font> T&amp; <a class="code" href="struct_VectorRep.html#a7">constref</a>(<font class="keywordtype">int</font> i)<font class="keyword"> const </font>{
00145 <font class="preprocessor">    #if ( SAFETY &gt; 0 )</font>
00146 <font class="preprocessor"></font>           <font class="keywordflow">if</font> ( i &lt; 0 || i &gt;= last - first ) <a class="code" href="error_h.html#a0">error</a>(<font class="stringliteral">"VectorOf index out of bounds"</font>
00147                         <font class="stringliteral">" in const T&amp; VectorRep::constref(int)"</font>);
00148 <font class="preprocessor">         #endif</font>
00149 <font class="preprocessor"></font>         <font class="keywordflow">return</font> vec[first + i];
00150   }
00151 
00152   <font class="comment">// for value access</font>
<a name="l00153"></a><a class="code" href="struct_VectorRep.html#a8">00153</a>   T <a class="code" href="struct_VectorRep.html#a8">val</a>(<font class="keywordtype">int</font> i)<font class="keyword"> const </font>{
00154 <font class="preprocessor">    #if ( SAFETY &gt; 0 )</font>
00155 <font class="preprocessor"></font>           <font class="keywordflow">if</font> ( i &lt; 0 || i &gt;= last - first ) <a class="code" href="error_h.html#a0">error</a>(<font class="stringliteral">"VectorOf index out of bounds"</font>
00156                         <font class="stringliteral">" in T&amp; VectorRep::val(int) const"</font>);
00157 <font class="preprocessor">         #endif</font>
00158 <font class="preprocessor"></font>         <font class="keywordflow">return</font> vec[first + i];
00159   }
00160 
<a name="l00161"></a><a class="code" href="struct_VectorRep.html#a9">00161</a>   <font class="keywordtype">void</font> <a class="code" href="struct_VectorRep.html#a9">append</a>( <font class="keyword">const</font> T&amp; t )<font class="keyword"> </font>{
00162          <font class="keywordflow">if</font> ( last &lt; len ) {
00163                 vec[last++] = t;
00164          }
00165          <font class="keywordflow">else</font> {
00166                 <font class="keywordflow">if</font> (fastExpansion &amp;&amp; len) len *= 2; <font class="keywordflow">else</font> len++;
00167                 T* new_vec = <font class="keyword">new</font> T[len];
00168 <font class="preprocessor">#if ( SAFETY &gt; 1 )</font>
00169 <font class="preprocessor"></font>                <font class="keywordflow">if</font>( !new_vec )
00170                   <a class="code" href="error_h.html#a0">error</a>(<font class="stringliteral">"Cannot allocate memory in VectorRep::append()"</font>);
00171 <font class="preprocessor">#endif</font>
00172 <font class="preprocessor"></font>                <font class="keywordtype">int</font> j = 0;
00173                 <font class="keywordflow">for</font>( <font class="keywordtype">int</font> i = first; i &lt; last; i++ )
00174                   new_vec[j++] = vec[i];
00175                 <font class="keyword">delete</font> [] vec;
00176                 vec = new_vec;
00177                 vec[j++] = t;
00178                 last = j;
00179                 first = 0;
00180          }
00181   }
00182 
<a name="l00183"></a><a class="code" href="struct_VectorRep.html#a10">00183</a>   <font class="keywordtype">void</font> <a class="code" href="struct_VectorRep.html#a10">prepend</a>( <font class="keyword">const</font> T&amp; t )<font class="keyword"> </font>{
00184          <font class="keywordflow">if</font> ( first &gt; 0 ) {
00185                 vec[--first] = t;
00186          }
00187          <font class="keywordflow">else</font> {
00188                 <font class="keywordflow">if</font> (fastExpansion &amp;&amp; len) len *= 2; <font class="keywordflow">else</font> len++;
00189                 T* new_vec = <font class="keyword">new</font> T[len];
00190 <font class="preprocessor">#if ( SAFETY &gt; 1 )</font>
00191 <font class="preprocessor"></font>                <font class="keywordflow">if</font>( !new_vec )
00192                   <a class="code" href="error_h.html#a0">error</a>(<font class="stringliteral">"Cannot allocate memory in VectorRep::prepend()"</font>);
00193 <font class="preprocessor">#endif</font>
00194 <font class="preprocessor"></font>                <font class="keywordtype">int</font> j = 0;
00195                 new_vec[j++] = t;
00196                 <font class="keywordflow">for</font>( <font class="keywordtype">int</font> i = first; i &lt; last; i++ )
00197                   new_vec[j++] = vec[i];
00198                 <font class="keyword">delete</font> [] vec;
00199                 vec = new_vec;
00200                 last = j;
00201                 first = 0;
00202          }
00203   }
00204 
<a name="l00205"></a><a class="code" href="struct_VectorRep.html#a11">00205</a>   <font class="keywordtype">void</font> <a class="code" href="struct_VectorRep.html#a11">shrink</a>( <font class="keywordtype">int</font> start, <font class="keywordtype">int</font> newlen )<font class="keyword"> </font>{
00206 <font class="preprocessor">    #if ( SAFETY &gt; 0 )</font>
00207 <font class="preprocessor"></font>      <font class="comment">// if ( start &lt; first || start &gt;= last || newlen &gt; last - first )</font>
00208       <font class="comment">//if ( start &lt; 0 || first + start &gt;= last || newlen &gt; last - first )</font>
00209       <font class="keywordflow">if</font> ( start &lt; 0 || newlen &lt; 0 || newlen &gt; last - first - start )
00210         <a class="code" href="error_h.html#a0">error</a>(<font class="stringliteral">"argument to VectorRep::shrink out of bounds"</font>);
00211 <font class="preprocessor">    #endif</font>
00212 <font class="preprocessor"></font>    <font class="comment">// The semantics are dangerous if we allow shrink to `expand' the VectorOf:</font>
00213     <font class="comment">// a copy construction may throw the `extra' stuff away in between</font>
00214     <font class="comment">// calls to shrink.</font>
00215     first += start;
00216     last = first + newlen;
00217   }
00218 <font class="comment"></font>
00219 <font class="comment">  /////////////////////////////////////////////////////////////////////////</font>
00220 <font class="comment"></font>  <font class="comment">//                                                                     //</font>
00221   <font class="comment">// IPC tools:                                                          //</font>
00222   <font class="comment">//                                                                     //</font><font class="comment"></font>
00223 <font class="comment">  /////////////////////////////////////////////////////////////////////////</font>
00224 <font class="comment"></font>
<a name="l00225"></a><a class="code" href="struct_VectorRep.html#a12">00225</a>   <font class="keywordtype">void</font> <a class="code" href="struct_VectorRep.html#a12">write</a>( ostream&amp; ostr )<font class="keyword"> const</font>
00226 <font class="keyword">  </font>{
00227 <font class="preprocessor">#ifdef DEBUG</font>
00228 <font class="preprocessor"></font>    ostr &lt; Chars(<font class="stringliteral">"Vector&lt;"</font>) &lt; <font class="charliteral">' '</font>;
00229 <font class="preprocessor">#endif    </font>
00230 <font class="preprocessor"></font>
00231     ostr &lt; fastExpansion &lt; first &lt; last &lt; len;
00232     <font class="keywordflow">for</font>( <font class="keywordtype">int</font> i = 0; i &lt; len; ++i ) {
00233        ostr &lt; vec[i];
00234        ostr &lt; <font class="charliteral">'\n'</font>; <font class="comment">//@dp temp</font>
00235       <font class="comment">// temporary cludge to avoid gcc 2.6.3 template bugs</font>
00236 <font class="comment">//      cludgeWrite(ostr, vec[i]);</font>
00237     }
00238 <font class="preprocessor">#ifdef DEBUG</font>
00239 <font class="preprocessor"></font>    ostr &lt; <font class="charliteral">' '</font> &lt; Chars(<font class="stringliteral">"&gt;Vector"</font>);
00240 <font class="preprocessor">#endif</font>
00241 <font class="preprocessor"></font>  }
00242 
<a name="l00243"></a><a class="code" href="struct_VectorRep.html#a13">00243</a>   <font class="keywordtype">void</font> <a class="code" href="struct_VectorRep.html#a13">read</a>( istream&amp; istr )<font class="keyword"></font>
00244 <font class="keyword">  </font>{
00245     <font class="keyword">delete</font> [] vec;
00246 
00247 <font class="preprocessor">#ifdef DEBUG</font>
00248 <font class="preprocessor"></font>    {
00249       <a class="code" href="class_Chars.html">Chars</a> header;
00250       istr &gt; header;
00251       <font class="keywordflow">if</font>( header != Chars(<font class="stringliteral">"Vector&lt;"</font>) ) {
00252         <a class="code" href="error_h.html#a0">error</a>(<font class="stringliteral">"Cannot load Vector&lt;T&gt;: bad header of the data section."</font>);
00253       }
00254     }
00255 <font class="preprocessor">#endif</font>
00256 <font class="preprocessor"></font>
00257     istr &gt; fastExpansion &gt; first &gt; last &gt; len;
00258     vec = <font class="keyword">new</font> T[len];
00259 <font class="preprocessor">#if ( SAFETY &gt; 1 )</font>
00260 <font class="preprocessor"></font>    <font class="keywordflow">if</font>( !vec )
00261       <a class="code" href="error_h.html#a0">error</a>(<font class="stringliteral">"Cannot allocate memory in VectorRep::read()"</font>);
00262 <font class="preprocessor">#endif</font>
00263 <font class="preprocessor"></font>    <font class="keywordflow">for</font>( <font class="keywordtype">int</font> i = 0; i &lt; len; ++i ) {
00264       istr &gt; vec[i];
00265       <font class="comment">// temporary cludge to avoid gcc 2.6.3 template bugs</font>
00266 <font class="comment">//      cludgeRead(istr, t);</font>
00267     }
00268 
00269 <font class="preprocessor">#ifdef DEBUG</font>
00270 <font class="preprocessor"></font>    {
00271       <a class="code" href="class_Chars.html">Chars</a> footer;
00272       istr &gt; footer;
00273       <font class="keywordflow">if</font>( footer != Chars(<font class="stringliteral">"&gt;Vector"</font>) ) {
00274         <a class="code" href="error_h.html#a0">error</a>(<font class="stringliteral">"Cannot load Vector&lt;T&gt;: bad footer of the data section."</font>);
00275       }
00276     }
00277 <font class="preprocessor">#endif</font>
00278 <font class="preprocessor"></font>  }
00279 
00280 
00281 <font class="comment">//@@db</font>
00282   
00283 <font class="comment">/*  inline void cludgeWrite( ostream&amp; ostr, const T&amp; t ) const { ostr &lt; t; }</font>
00284 <font class="comment"></font>
00285 <font class="comment">  inline void cludgeRead( istream&amp; istr, T&amp; t ) { istr &gt; t; }*/</font>
00286 
00287    
00288 <font class="keyword">private</font> :
00289   
00290   <font class="comment">// assignment operator undesired : made private</font>
00291   
00292   <a class="code" href="struct_VectorRep.html">VectorRep</a>&amp; <a class="code" href="class_RefCounter.html#c0">operator = </a>( <font class="keyword">const</font> <a class="code" href="struct_VectorRep.html">VectorRep</a>&amp; );<font class="comment">//@dp { }//@rn</font>
00293   <font class="comment">// hidden, not to be implemented</font>
00294 
00295   <font class="comment">// data members</font>
00296   
<a name="l00297"></a><a class="code" href="struct_VectorRep.html#o0">00297</a>   <font class="keywordtype">bool</font> fastExpansion; <font class="comment">// true if expansion should be done by doubling space </font>
<a name="l00298"></a><a class="code" href="struct_VectorRep.html#o1">00298</a>   <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> first; <font class="comment">// index of first valid entry</font>
<a name="l00299"></a><a class="code" href="struct_VectorRep.html#o2">00299</a>   <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> last;  <font class="comment">// index + 1 of last valid entry</font>
<a name="l00300"></a><a class="code" href="struct_VectorRep.html#o3">00300</a>   <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> len;   <font class="comment">// actual length of storage, so last - first &lt;= len</font>
00301   
<a name="l00302"></a><a class="code" href="struct_VectorRep.html#o4">00302</a>   T* vec;
00303 
00304 };
00305 
00306 <font class="comment">/*</font>
00307 <font class="comment">//@db temporary cludges to avoid gcc template bugs</font>
00308 <font class="comment"></font>
00309 <font class="comment">inline void VectorRep&lt;Chars&gt;::cludgeWrite( ostream&amp; ostr, const Chars&amp; t )</font>
00310 <font class="comment">       const { ostr &lt; t; }</font>
00311 <font class="comment"></font>
00312 <font class="comment">inline void VectorRep&lt;Chars&gt;::cludgeRead( istream&amp; istr, Chars&amp; t )</font>
00313 <font class="comment">       { istr &gt; t; }</font>
00314 <font class="comment"></font>
00315 <font class="comment">inline void VectorRep&lt;int&gt;::cludgeWrite( ostream&amp; ostr, const int&amp; t ) const</font>
00316 <font class="comment">       { ostr &lt; t; }</font>
00317 <font class="comment"></font>
00318 <font class="comment">inline void VectorRep&lt;int&gt;::cludgeRead( istream&amp; istr, int&amp; t ) { istr &gt; t; }</font>
00319 <font class="comment"></font>
00320 <font class="comment">//@db end of cludges</font>
00321 <font class="comment">*/</font>
00322 
00323 
00324 <font class="comment">// ------------------------------- VectorOf -------------------------------- //</font>
00325 
00326 
00327 <font class="comment">//@db 2.91</font>
00328 
00329 template &lt;class T&gt; <font class="keyword">class </font><a class="code" href="class_VectorOf.html">VectorOf</a>;
00330 
00331 template&lt;class T&gt;
<a name="l00332"></a><a class="code" href="Vector_h.html#a0">00332</a> ostream&amp; operator &lt; ( ostream&amp; ostr, const VectorOf&lt;T&gt;&amp; v )
00333 {
00334   v.look()-&gt;write(ostr);
00335   <font class="keywordflow">return</font> ostr;
00336 }
00337 
00338 template&lt;class T&gt;
<a name="l00339"></a><a class="code" href="Vector_h.html#a1">00339</a> istream&amp; <a class="code" href="Polynomial_h.html#a3">operator &gt; </a>( istream&amp; istr, <a class="code" href="class_VectorOf.html">VectorOf&lt;T&gt;</a>&amp; v )<font class="keyword"></font>
00340 <font class="keyword"></font>{
00341   v.<a class="code" href="class_ObjectOf.html#b2">change</a>()-&gt;read(istr);
00342   <font class="keywordflow">return</font> istr;
00343 }
00344 
00345 <font class="comment">//@db end</font>
00346 
00347 
<a name="l00348"></a><a class="code" href="class_VectorOf.html">00348</a> template &lt;class T&gt; <font class="keyword">class </font><a class="code" href="class_VectorOf.html">VectorOf</a> : <font class="keyword">public</font> <a class="code" href="class_ObjectOf.html">ObjectOf</a>&lt; VectorRep&lt;T&gt; &gt; {
00349   
<a name="l00350"></a><a class="code" href="class_VectorOf.html#u0">00350</a>   <font class="keyword">typedef</font> <a class="code" href="struct_VectorRep.html">VectorRep&lt; T &gt;</a> <a class="code" href="struct_VectorRep.html">Tvr</a>;
<a name="l00351"></a><a class="code" href="class_VectorOf.html#u1">00351</a>   <font class="keyword">typedef</font> <a class="code" href="class_ObjectOf.html">ObjectOf&lt; Tvr &gt;</a> <a class="code" href="struct_VectorPtrRep.html">Rep</a>;
00352   
00353 <font class="keyword">public</font>:
00354   
00355   <font class="comment">// copy constructor, operator=, and destructor supplied by compiler.</font>
00356   
<a name="l00357"></a><a class="code" href="class_VectorOf.html#a0">00357</a>   <a class="code" href="class_VectorOf.html#a0">VectorOf</a>( <font class="keywordtype">int</font> len = 0 ) : <a class="code" href="struct_VectorPtrRep.html">Rep</a>( new <a class="code" href="struct_VectorRep.html">Tvr</a>(len) ) { }
00358 
<a name="l00359"></a><a class="code" href="class_VectorOf.html#a1">00359</a>   <a class="code" href="class_VectorOf.html#a0">VectorOf</a>( <font class="keywordtype">int</font> len, <font class="keywordtype">bool</font> e ) : <a class="code" href="struct_VectorPtrRep.html">Rep</a>( new <a class="code" href="struct_VectorRep.html">Tvr</a>(len,e) ) { }
00360   <font class="comment">// When e is true, the vector length doubles when an append or prepend</font>
00361   <font class="comment">// needs more space (instead of increasing by 1).</font>
00362 
<a name="l00363"></a><a class="code" href="class_VectorOf.html#a2">00363</a>   <a class="code" href="class_VectorOf.html#a0">VectorOf</a>( <font class="keywordtype">int</font> len, <font class="keyword">const</font> <a class="code" href="class_VectorOf.html">VectorOf</a>&amp; v ) : <a class="code" href="struct_VectorPtrRep.html">Rep</a>( new <a class="code" href="struct_VectorRep.html">Tvr</a>(len) ) {
00364 
00365         <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i = 0; i &lt; <a class="code" href="global_h.html#a5">min</a>( len, v.length() ); i++)
00366                 <a class="code" href="class_ObjectOf.html#b1">enhance</a>()-&gt;ref(i) = v[i];
00367   }
00368   <font class="comment">// to make a vector of given length, (partly) initialized with</font>
00369   <font class="comment">// (part of) another vector</font>
00370 
<a name="l00371"></a><a class="code" href="class_VectorOf.html#a3">00371</a>   <a class="code" href="class_VectorOf.html#a0">VectorOf</a>( <font class="keywordtype">int</font> len, <font class="keywordtype">bool</font> e, <font class="keyword">const</font> <a class="code" href="class_VectorOf.html">VectorOf</a>&amp; v ) : <a class="code" href="struct_VectorPtrRep.html">Rep</a>( new <a class="code" href="struct_VectorRep.html">Tvr</a>(len,e) ) {
00372         <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i = 0; i &lt; <a class="code" href="global_h.html#a5">min</a>( len, v.length() ); i++)
00373                 <a class="code" href="class_ObjectOf.html#b1">enhance</a>()-&gt;ref(i) = v[i];
00374   }
00375   <font class="comment">// See comment for VectorOf( int len, bool e ).</font>
00376 
<a name="l00377"></a><a class="code" href="class_VectorOf.html#a4">00377</a>   <font class="keywordtype">int</font> <a class="code" href="Property_h.html#a1">operator == </a>( <font class="keyword">const</font> <a class="code" href="class_VectorOf.html">VectorOf</a>&amp; v )<font class="keyword"> const</font>
00378 <font class="keyword">  </font>{
00379          <font class="keywordflow">if</font> (<a class="code" href="class_ObjectOf.html#b0">look</a>() == v.<a class="code" href="class_ObjectOf.html#b0">look</a>()) <font class="keywordflow">return</font> 1;
00380          <font class="keywordflow">if</font> ( <a class="code" href="class_ObjectOf.html#b0">look</a>()-&gt;length() != v.<a class="code" href="class_ObjectOf.html#b0">look</a>()-&gt;<a class="code" href="struct_VectorPtrRep.html#a5">length</a>() ) <font class="keywordflow">return</font> 0;
00381          <font class="keywordtype">int</font> i = <a class="code" href="class_ObjectOf.html#b0">look</a>()-&gt;length();
00382          <font class="keywordflow">while</font> ( i-- ) <font class="keywordflow">if</font> ( !(<a class="code" href="class_ObjectOf.html#b0">look</a>()-&gt;val(i) == v.<a class="code" href="class_ObjectOf.html#b0">look</a>()-&gt;<a class="code" href="struct_VectorPtrRep.html#a9">val</a>(i)) ) <font class="keywordflow">return</font> 0;
00383          <font class="keywordflow">return</font> 1;
00384   }
00385   
<a name="l00386"></a><a class="code" href="class_VectorOf.html#a5">00386</a>   <font class="keywordtype">int</font> <a class="code" href="Property_h.html#a2">operator != </a>( <font class="keyword">const</font> <a class="code" href="class_VectorOf.html">VectorOf</a>&amp; v )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> !(*<font class="keyword">this</font> == v); }
00387 
<a name="l00388"></a><a class="code" href="class_VectorOf.html#a6">00388</a>   T <a class="code" href="class_VectorOf.html#a6">operator [] </a>( <font class="keywordtype">int</font> i )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> <a class="code" href="class_ObjectOf.html#b0">look</a>()-&gt;val(i); }
00389 
<a name="l00390"></a><a class="code" href="class_VectorOf.html#a7">00390</a>   T&amp; <a class="code" href="class_VectorOf.html#a6">operator [] </a>( <font class="keywordtype">int</font> i )<font class="keyword"> </font>{ <font class="keywordflow">return</font> <a class="code" href="class_ObjectOf.html#b2">change</a>()-&gt;ref(i); }
00391 
00392   <font class="comment">//@rn Temporary (perhaps should be permanent) additions of Sergei:</font>
00393 
<a name="l00394"></a><a class="code" href="class_VectorOf.html#a8">00394</a>   T <a class="code" href="class_VectorOf.html#a8">val</a>( <font class="keywordtype">int</font> i )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> <a class="code" href="class_ObjectOf.html#b0">look</a>()-&gt;val(i); }
<a name="l00395"></a><a class="code" href="class_VectorOf.html#a9">00395</a>   T&amp; <a class="code" href="class_VectorOf.html#a9">ref</a>( <font class="keywordtype">int</font> i )<font class="keyword"> </font>{ <font class="keywordflow">return</font> <a class="code" href="class_ObjectOf.html#b2">change</a>()-&gt;ref(i); }
<a name="l00396"></a><a class="code" href="class_VectorOf.html#a10">00396</a>   <font class="keyword">const</font> T&amp; <a class="code" href="class_VectorOf.html#a10">constref</a>( <font class="keywordtype">int</font> i )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> <a class="code" href="class_ObjectOf.html#b0">look</a>()-&gt;constref(i); }
00397 
00398   <font class="comment">//@rn</font>
00399   
<a name="l00400"></a><a class="code" href="class_VectorOf.html#a11">00400</a>   <font class="keywordtype">int</font> <a class="code" href="class_VectorOf.html#a11">length</a>( )<font class="keyword"> const </font>{ <font class="keywordflow">return</font> <a class="code" href="class_ObjectOf.html#b0">look</a>()-&gt;length(); }
00401 
<a name="l00402"></a><a class="code" href="class_VectorOf.html#a12">00402</a>   <font class="keywordtype">int</font> <a class="code" href="class_VectorOf.html#a12">hash</a>()<font class="keyword"> const </font>{ <font class="keywordflow">return</font> <a class="code" href="class_ObjectOf.html#b0">look</a>()-&gt;length(); }
00403   <font class="comment">//@rn Replace this in specific template instances if you want</font>
00404   <font class="comment">//    any semblance of efficiency.</font>
00405   
<a name="l00406"></a><a class="code" href="class_VectorOf.html#a13">00406</a>   <font class="keywordtype">int</font> <a class="code" href="class_VectorOf.html#a13">indexOf</a>( <font class="keyword">const</font> T&amp; t )<font class="keyword"> const </font>{
00407          <font class="keywordtype">int</font> i = <a class="code" href="class_VectorOf.html#a11">length</a>();
00408          <font class="keywordflow">while</font> ( i-- ) <font class="keywordflow">if</font> ( <a class="code" href="class_ObjectOf.html#b0">look</a>()-&gt;val(i) == t ) <font class="keywordflow">return</font> i;
00409          <font class="keywordflow">return</font> -1;
00410   }
00411   <font class="comment">// Returns the index of t in this VectorOf, or -1 if not here.</font>
00412   
<a name="l00413"></a><a class="code" href="class_VectorOf.html#a14">00413</a>   <font class="keywordtype">void</font> <a class="code" href="class_VectorOf.html#a14">append</a>( <font class="keyword">const</font> T&amp; t )<font class="keyword"> </font>{ <a class="code" href="class_ObjectOf.html#b2">change</a>()-&gt;append(t); }
00414   <font class="comment">// Appends t to this VectorOf.</font>
00415   
<a name="l00416"></a><a class="code" href="class_VectorOf.html#a15">00416</a>   <font class="keywordtype">void</font> <a class="code" href="class_VectorOf.html#a15">prepend</a>( <font class="keyword">const</font> T&amp; t )<font class="keyword"> </font>{ <a class="code" href="class_ObjectOf.html#b2">change</a>()-&gt;prepend(t); }
00417   <font class="comment">// Prepends t to this VectorOf.</font>
00418 
<a name="l00419"></a><a class="code" href="class_VectorOf.html#a16">00419</a>   <font class="keywordtype">void</font> <a class="code" href="class_VectorOf.html#a16">shrink</a>( <font class="keywordtype">int</font> newLength )<font class="keyword"> </font>{ <a class="code" href="class_ObjectOf.html#b2">change</a>()-&gt;shrink(0, newLength); }
<a name="l00420"></a><a class="code" href="class_VectorOf.html#a17">00420</a>   <font class="keywordtype">void</font> <a class="code" href="class_VectorOf.html#a16">shrink</a>( <font class="keywordtype">int</font> start, <font class="keywordtype">int</font> newLength )<font class="keyword"></font>
00421 <font class="keyword">        </font>{ <a class="code" href="class_ObjectOf.html#b2">change</a>()-&gt;shrink(start, newLength); }
00422 
00423 <font class="comment">// I/O :</font>
00424  
00425     <font class="comment">// @stc these should not be inlined here but its easier than</font>
00426     <font class="comment">// fighting with g++'s template shortcomings</font>
<a name="l00427"></a><a class="code" href="class_VectorOf.html#l0">00427</a>     <font class="keyword">inline</font> <font class="keyword">friend</font> ostream&amp; <a class="code" href="DatabaseManager_h.html#a28">operator &lt;&lt; </a>( ostream&amp; o, <font class="keyword">const</font> <a class="code" href="class_VectorOf.html">VectorOf</a>&amp; v )<font class="keyword"> </font>{
00428  
00429         o &lt;&lt; <font class="stringliteral">"&lt;"</font>;
00430         <font class="keywordflow">if</font> ( v.<a class="code" href="class_VectorOf.html#a11">length</a>() == 0 )
00431             o &lt;&lt; <font class="stringliteral">" "</font>;
00432         <font class="keywordflow">else</font>
00433             o &lt;&lt; v[0];
00434         <font class="keywordflow">for</font> ( <font class="keywordtype">int</font> i = 1; i &lt; v.<a class="code" href="class_VectorOf.html#a11">length</a>(); i++ ) o &lt;&lt; <font class="stringliteral">","</font> &lt;&lt; v[i];
00435         o &lt;&lt; <font class="stringliteral">"&gt;"</font>;
00436         <font class="keywordflow">return</font> o;
00437     }
00438 
00439 <font class="comment"></font>
00440 <font class="comment">  /////////////////////////////////////////////////////////////////////////</font>
00441 <font class="comment"></font>  <font class="comment">//                                                                     //</font>
00442   <font class="comment">// IPC tools:                                                          //</font>
00443   <font class="comment">//                                                                     //</font><font class="comment"></font>
00444 <font class="comment">  /////////////////////////////////////////////////////////////////////////</font>
00445 <font class="comment"></font>
00446   <font class="keyword">friend</font> ostream&amp; operator &lt; &lt;T&gt;( ostream&amp; ostr, <font class="keyword">const</font> <a class="code" href="class_VectorOf.html">VectorOf</a>&amp; v );
00447   
00448   <font class="keyword">friend</font> istream&amp; operator &gt; &lt;T&gt;( istream&amp; istr, <a class="code" href="class_VectorOf.html">VectorOf</a>&amp; v );
00449   
00450 <font class="keyword">private</font>:
00451 
00452 
00453 };
00454 
00455 
00456 
00457 <font class="comment">// concatenate the given vectors</font>
00458 
00459 template &lt;class T&gt;
<a name="l00460"></a><a class="code" href="Vector_h.html#a2">00460</a> <font class="keyword">inline</font> <a class="code" href="class_VectorOf.html">VectorOf&lt;T&gt;</a> <a class="code" href="Vector_h.html#a2">concatenate</a>(<font class="keyword">const</font> <a class="code" href="class_VectorOf.html">VectorOf&lt;T&gt;</a>&amp; v1, <font class="keyword">const</font> <a class="code" href="class_VectorOf.html">VectorOf&lt;T&gt;</a>&amp; v2)<font class="keyword"></font>
00461 <font class="keyword"></font>{
00462   <a class="code" href="class_VectorOf.html">VectorOf&lt;T&gt;</a> res(v1.<a class="code" href="class_VectorOf.html#a11">length</a>()+v2.<a class="code" href="class_VectorOf.html#a11">length</a>());
00463   <font class="keywordtype">int</font> pos = 0;
00464   <font class="keywordflow">for</font>(<font class="keywordtype">int</font> i = 0; i &lt; v1.<a class="code" href="class_VectorOf.html#a11">length</a>(); i++)
00465     res[pos++] = v1[i];
00466   <font class="keywordflow">for</font>(<font class="keywordtype">int</font> j = 0; j &lt; v2.<a class="code" href="class_VectorOf.html#a11">length</a>(); j++)
00467     res[pos++] = v2[j];
00468   <font class="keywordflow">return</font> res;
00469 }
00470 
00471 
00472 <font class="preprocessor">#endif</font>
</font></pre></div><hr><address><small>Generated at Tue Jun 19 09:49:35 2001 for Magnus Classes by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.6 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2001</small></address>
</body>
</html>
